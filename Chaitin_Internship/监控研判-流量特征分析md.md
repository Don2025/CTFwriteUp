# 监控研判—流量特征分析

#### 常见`webshell`的流量特征，蚁剑、冰蝎和哥斯拉木马的连接特征

- 高危函数：`eval()`、`assert()`
- 蚁剑：`User-Agent`值`antSword/*`，请求体`@ini_set("display_errors", "0"); @set_time_limit(0);`，参数多为`0x`开头
- 菜刀：明文、伪造 `X-Forwarded-For`头，每次利用时`X-Forwarded-For`头都会不同，执行 `base64_decode()` 函数对 `z0` 进行 `base64` 解码后，经过 `eval()` 函数执行命令
- 冰蝎：消息体内容采用`AES128`加密，流量会根据时间来生成长度为`16`的随机`key`，中间结果字符串 `assert|eval("phpinfo();")`此数据由冰蝎加载器定义好并发出的
- 哥斯拉：`cookie`字段最后一个值后面有分号

#### 常见框架（`fastjson`、`log4j`、`shiro`、`struts2`）漏洞的流量特征？

- （主要看这些常见框架漏洞的`payload`了解漏洞原理、监控告警需要判断是否为误报、了解常见的攻击载荷）

- `fastjson`：`@type Templateslmpl`
- `log4j`：`${}`，`jndi`，`rmi`，`ldap`
- `shiro`：`RemeberMe`，`DeleteMe`

#### 对于注入类漏洞，应该如何判断攻击是否成功，以及攻击者的攻击深度（是正在判断注入点还是以及获取数据或者已经拿到权限）？

#### 假如在`IPS`上发现以条关于文件上传的警告，应该如何判断是否为误报或者攻击是否成功？

#### 对于`0day`漏洞的攻击流量应该如何进行分析研判？

#### 如果已经攻击成功，并且已经在内网中进行横向，应该如何对攻击者的攻击路径进行梳理？

#### 描述参与过的护网的应急细节和排查思路？

#### 挖矿警告和钓鱼邮件的分析思路？